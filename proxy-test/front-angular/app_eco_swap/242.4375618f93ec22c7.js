"use strict";(self.webpackChunkapp_eco_swap=self.webpackChunkapp_eco_swap||[]).push([[242],{6242:(oi,g,a)=>{a.r(g),a.d(g,{PublicacionesModule:()=>W});var d=a(4755),m=a(1531),v=a(8675),P=a(4004),C=a(5226),x=a.n(C),i=a(2223),T=a(4377),s=a(9401),A=a(4893),M=a(3073),O=a(2777),Z=a(4666),f=a(9114),L=a(430),I=a(9609),y=a(1728),F=a(787),J=a(1217),h=a(8995),p=a(6996),S=a(3649),b=a(4867),r=a(3148),U=a(7876),w=a(4984),N=a(9229);function Q(n,c){if(1&n){const o=i.EpF();i.TgZ(0,"mat-chip-row",33),i.NdJ("removed",function(){const l=i.CHM(o).$implicit,u=i.oxw(4);return i.KtG(u.remove(l))}),i._uU(1),i.TgZ(2,"button",34)(3,"mat-icon",35),i._uU(4,"cancel"),i.qZA()()()}if(2&n){const o=c.$implicit;i.Q6J("matTooltip",o),i.xp6(1),i.hij(" ",o," "),i.xp6(1),i.uIk("aria-label","eliminar "+o)}}function Y(n,c){if(1&n&&(i.TgZ(0,"mat-option",36),i._uU(1),i.qZA()),2&n){const o=c.$implicit;i.Q6J("value",o),i.xp6(1),i.hij(" ",o," ")}}function R(n,c){if(1&n&&(i.TgZ(0,"mat-option",36),i._uU(1),i.qZA()),2&n){const o=c.$implicit;i.Q6J("value",o.nombre),i.xp6(1),i.hij(" ",o.descripcion," ")}}function D(n,c){if(1&n){const o=i.EpF();i.TgZ(0,"form",18)(1,"mat-form-field",19)(2,"mat-label"),i._uU(3,"Localidades"),i.qZA(),i.TgZ(4,"mat-chip-grid",20,21),i.YNc(6,Q,5,3,"mat-chip-row",22),i.TgZ(7,"input",23,24),i.NdJ("matChipInputTokenEnd",function(e){i.CHM(o);const l=i.oxw(3);return i.KtG(l.add(e))}),i.qZA()(),i.TgZ(9,"mat-autocomplete",25,26),i.NdJ("optionSelected",function(e){i.CHM(o);const l=i.MAs(8);return i.oxw(3).selected(e),i.KtG(l.value="")}),i.YNc(11,Y,2,2,"mat-option",27),i.ALo(12,"async"),i.qZA()(),i.TgZ(13,"mat-form-field",28)(14,"mat-label"),i._uU(15,"Tipo del Producto"),i.qZA(),i.TgZ(16,"mat-select",29),i.YNc(17,R,2,2,"mat-option",27),i.qZA()(),i.TgZ(18,"div",30)(19,"button",31),i.NdJ("click",function(){i.CHM(o);const e=i.oxw(3);return i.KtG(e.filtrarPublicaciones())}),i._uU(20,"FILTRAR"),i.qZA(),i.TgZ(21,"button",32),i.NdJ("click",function(){i.CHM(o);const e=i.oxw(3);return i.KtG(e.limpiarFiltros())}),i._uU(22,"LIMPIAR"),i.qZA()()()}if(2&n){const o=i.MAs(5),t=i.MAs(10),e=i.oxw(3);i.Q6J("formGroup",e.formFiltros),i.xp6(6),i.Q6J("ngForOf",e.localidades),i.xp6(1),i.Q6J("matChipInputFor",o)("matAutocomplete",t),i.xp6(4),i.Q6J("ngForOf",i.lcZ(12,6,e.filteredLocalidades)),i.xp6(6),i.Q6J("ngForOf",e.tipos_productos)}}function B(n,c){if(1&n){const o=i.EpF();i.TgZ(0,"div",37)(1,"mat-radio-group",38),i.NdJ("change",function(e){i.CHM(o);const l=i.oxw(3);return i.KtG(l.filterByStatus(e))}),i.TgZ(2,"mat-radio-button",39),i._uU(3,"Todas"),i.qZA(),i.TgZ(4,"mat-radio-button",40),i._uU(5,"Abiertas"),i.qZA(),i.TgZ(6,"mat-radio-button",41),i._uU(7,"Cerradas"),i.qZA()()()}}function E(n,c){if(1&n&&(i.YNc(0,D,23,8,"form",16),i.YNc(1,B,8,0,"div",17)),2&n){const o=i.oxw(2);i.Q6J("ngIf","all"==o.origin),i.xp6(1),i.Q6J("ngIf","myPublicaciones"==o.origin)}}function G(n,c){1&n&&(i.TgZ(0,"div",7,8)(2,"div",9,10)(4,"h2",11)(5,"button",12)(6,"mat-icon"),i._uU(7,"tune"),i.qZA(),i.TgZ(8,"span",13),i._uU(9,"Filtros"),i.qZA()()(),i.TgZ(10,"div",14)(11,"div",15),i.YNc(12,E,2,2,"ng-template"),i.qZA()()()()),2&n&&(i.xp6(2),i.Q6J("collapsed",!1))}function H(n,c){1&n&&(i.TgZ(0,"div",30),i._uU(1,"No hay publicaciones para mostrar"),i.qZA())}function $(n,c){if(1&n&&i._UZ(0,"app-deck",46),2&n){const o=i.oxw(2);i.Q6J("cardList",o.filteredPublicacionesCardList)}}function j(n,c){if(1&n&&(i.TgZ(0,"div",42),i._UZ(1,"app-spinner",43),i.YNc(2,H,2,0,"div",44),i.YNc(3,$,1,1,"app-deck",45),i.qZA()),2&n){const o=i.oxw();i.xp6(1),i.Q6J("loading",o.loading),i.xp6(1),i.Q6J("ngIf",0==o.filteredPublicacionesCardList.length),i.xp6(1),i.Q6J("ngIf",o.filteredPublicacionesCardList.length>0)}}const q=[{path:"",component:(()=>{class n{constructor(o,t,e,l,u,k,ii){this.router=o,this.auth=t,this.fb=e,this.productosService=l,this.showErrorService=u,this.truequesService=k,this.comprasService=ii,this.origin="all",this.tipos_productos=[],this.loading=!1,this.publicacionesToShow=[],this.localidades=[],this.allLocalidades=[],this.publicacionesCardList=[],this.filteredPublicacionesCardList=[],this.trueques=[],this.formFiltros=e.group({fundacion:[""],localidad:[""],tipoProducto:[""]}),"/mis-publicaciones"==o.url&&(this.origin="myPublicaciones"),"/mis-compras"==o.url&&(this.origin="myCompras"),this.filteredLocalidades=this.formFiltros.controls.localidad.valueChanges.pipe((0,v.O)(""),(0,P.U)(_=>_?this._filterLocalidad(_):this.allLocalidades.slice())),this.getTiposProductos(),this.getLocalidades(),this.filtrarPublicaciones()}addPublicacion(){this.auth.isUserLoggedIn?this.router.navigate(["form-publicacion"]):x().fire({title:"\xa1Necesit\xe1s una cuenta!",text:"Para poder crear una publicaci\xf3n, ten\xe9s que usar tu cuenta.",icon:"warning",confirmButtonText:"Iniciar sesi\xf3n",showCancelButton:!0,cancelButtonText:"Cancelar"}).then(({isConfirmed:o})=>{o&&this.router.navigate(["login"])})}getTiposProductos(){this.productosService.getTiposProductos().subscribe({next:o=>this.tipos_productos=o,error:o=>console.error("error",o)})}filtrarPublicaciones(){if("all"==this.origin){this.filtros={};const o=this.formFiltros.controls.tipoProducto.value;this.localidades.length>0&&(this.filtros.localidades=this.localidades),o&&(this.filtros.tipoProducto=o),this.truequesService.getPublicaciones(this.filtros).subscribe({next:t=>{console.log(t),this.publicacionesToShow=t,this.publicacionesToShow.map(e=>{e.parsedImagenes=e.imagenes.split("|")})},complete:()=>this.generateCardList()})}else"myPublicaciones"==this.origin?this.truequesService.getMisPublicaciones().subscribe({next:o=>{console.log(o),this.publicacionesToShow=o,this.publicacionesToShow.map(t=>{t.parsedImagenes=t.imagenes.split("|")})},complete:()=>{this.truequesService.getTruequesParticular(this.publicacionesToShow[0].particularDTO.idParticular).subscribe({next:o=>{this.trueques=o},complete:()=>this.generateCardList()})}}):this.comprasService.getMyCompras().subscribe({next:o=>{console.log(o);for(const t of o)this.publicacionesToShow.push(t.publicacionDTO);this.publicacionesToShow.map(t=>{t.parsedImagenes=t.imagenes.split("|")})},complete:()=>this.generateCardList()})}generateCardList(){this.publicacionesCardList.splice(0);for(const o of this.publicacionesToShow){let t;if("CERRADA"==o.estadoPublicacion){const e=this.trueques.find(l=>"APROBADO"==l.estadoTrueque&&l.publicacionDTOpropuesta.idPublicacion==o.idPublicacion);e&&(t=e.publicacionDTOorigen.idPublicacion)}this.publicacionesCardList.push({id:o.idPublicacion,imagen:o.parsedImagenes?o.parsedImagenes[0]:"no_image",titulo:o.titulo,valorPrincipal:`$${o.valorTruequeMin} - $${o.valorTruequeMax}`,valorSecundario:o.precioVenta?`$${o.precioVenta}`:void 0,fecha:o.fechaPublicacion,usuario:{imagen:o.particularDTO.usuarioDTO.avatar,nombre:o.particularDTO.nombre+" "+o.particularDTO.apellido,puntaje:o.particularDTO.puntaje,localidad:o.particularDTO.direcciones[0].localidad},action:t?"trueque":"myPublicaciones"==this.origin?"list":"access",idAuxiliar:t||void 0,buttons:[],estado:"myPublicaciones"==this.origin?o.estadoPublicacion:void 0,codigo:"Publicaci\xf3n"})}this.filteredPublicacionesCardList=this.publicacionesCardList}limpiarFiltros(){this.formFiltros.reset(),this.localidades=[],this.filtrarPublicaciones()}getLocalidades(){fetch("https://apis.datos.gob.ar/georef/api/localidades?orden=id&provincia=02&max=50&campos=nombre").then(t=>t.json()).then(t=>{for(const e of t.localidades)this.allLocalidades.push(e.nombre)}).catch(t=>console.error(t))}add(o){const t=(o.value||"").trim();t&&this.allLocalidades.some(e=>e.toUpperCase()==t.toUpperCase())&&this.localidades.push(t),o.chipInput.clear(),this.formFiltros.controls.localidad.setValue(null),console.log("add",this.formFiltros.controls.localidad.value)}remove(o){const t=this.localidades.indexOf(o);t>=0&&this.localidades.splice(t,1)}selected(o){this.localidades.push(o.option.viewValue),this.formFiltros.controls.localidad.setValue("")}_filterLocalidad(o){const t=o.toLowerCase();return this.allLocalidades.filter(e=>e.toLowerCase().includes(t))}filterByStatus(o){const t="open"==o.value?"ABIERTA":"closed"==o.value?"CERRADA":["ABIERTA","CERRADA"];this.filteredPublicacionesCardList=this.publicacionesCardList.filter(e=>e.estado&&t.includes(e.estado))}}return n.\u0275fac=function(o){return new(o||n)(i.Y36(m.F0),i.Y36(T.e),i.Y36(s.qu),i.Y36(A.k),i.Y36(M.x),i.Y36(O.x),i.Y36(Z.K))},n.\u0275cmp=i.Xpm({type:n,selectors:[["app-trueque"]],decls:9,vars:3,consts:[[3,"title"],["id","main-publicaciones",1,"app-main-div"],[1,"dense-3"],["ngbAccordion","",4,"ngIf"],["class","row",4,"ngIf"],[1,"floating-button-container"],["mat-fab","","color","primary","aria-label","Agregar Publicaci\xf3n","matTooltip","Agregar Publicaci\xf3n","matTooltipPosition","before",3,"click"],["ngbAccordion",""],["accordion","ngbAccordion"],["ngbAccordionItem","first",3,"collapsed"],["first","ngbAccordionItem"],["ngbAccordionHeader",""],["ngbAccordionButton","",1,"bg-transparent","accordion-header-button"],[2,"margin-left","10px"],["ngbAccordionCollapse",""],["ngbAccordionBody",""],["id","form-filtros",3,"formGroup",4,"ngIf"],["style","min-width: 210px;",4,"ngIf"],["id","form-filtros",3,"formGroup"],["appearance","outline",1,"example-chip-list"],["aria-label","Localidad"],["chipGrid",""],[3,"matTooltip","removed",4,"ngFor","ngForOf"],["placeholder","Localidad...","formControlName","localidad","matInput","",3,"matChipInputFor","matAutocomplete","matChipInputTokenEnd"],["localidadInput",""],[3,"optionSelected"],["autoLocalidad","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline"],["formControlName","tipoProducto","panelClass","example-panel"],[2,"text-align","center"],["mat-fab","","extended","","color","primary",3,"click"],["mat-fab","","extended","",2,"background-color","white",3,"click"],[3,"matTooltip","removed"],["matChipRemove",""],[2,"height","16px"],[3,"value"],[2,"min-width","210px"],["value","all",2,"display","flex","flex-direction","column",3,"change"],["value","all"],["value","open"],["value","closed"],[1,"row"],[3,"loading"],["style","text-align: center;",4,"ngIf"],["app","publicaciones",3,"cardList",4,"ngIf"],["app","publicaciones",3,"cardList"]],template:function(o,t){1&o&&(i._UZ(0,"app-header",0),i.TgZ(1,"div",1)(2,"div",2),i.YNc(3,G,13,1,"div",3),i.qZA(),i.YNc(4,j,4,3,"div",4),i.TgZ(5,"div",5)(6,"button",6),i.NdJ("click",function(){return t.addPublicacion()}),i.TgZ(7,"mat-icon"),i._uU(8,"add"),i.qZA()()()()),2&o&&(i.Q6J("title","all"==t.origin?"Publicaciones":"myPublicaciones"==t.origin?"Mis Publicaciones":"Mis Compras"),i.xp6(3),i.Q6J("ngIf","myCompras"!=t.origin),i.xp6(1),i.Q6J("ngIf",!t.loading))},dependencies:[d.sg,d.O5,f.KE,f.hX,L.Hw,I.Nt,y.cs,F.gD,J.ey,h.XC,h.ZL,p.RA,p.oH,p.qH,p.z3,S.gM,b.VQ,b.U0,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,r.fD,r.QQ,r.VE,r.I,r.fA,r.ud,U.G,w.O,N.o,d.Ov],styles:["#main-publicaciones[_ngcontent-%COMP%]{padding:2%;display:grid;grid-template-columns:1fr 5fr;gap:20px}#main-publicaciones[_ngcontent-%COMP%]   .accordion[_ngcontent-%COMP%]{padding:10px 0}#main-publicaciones[_ngcontent-%COMP%]   .accordion[_ngcontent-%COMP%]   .accordion-item[_ngcontent-%COMP%]{border-radius:10px;box-shadow:0 2px 1px -1px #0003,0 1px 1px #00000024,0 1px 3px #0000001f}#main-publicaciones[_ngcontent-%COMP%]   .accordion[_ngcontent-%COMP%]   .accordion-item[_ngcontent-%COMP%]   .accordion-header[_ngcontent-%COMP%]{margin:0}#main-publicaciones[_ngcontent-%COMP%]   .accordion[_ngcontent-%COMP%]   .accordion-item[_ngcontent-%COMP%]   .accordion-header[_ngcontent-%COMP%]   .accordion-header-button[_ngcontent-%COMP%]{height:40px;font-size:14px;padding:10px}#main-publicaciones[_ngcontent-%COMP%]   #form-filtros[_ngcontent-%COMP%]{display:flex;flex-direction:column}#main-publicaciones[_ngcontent-%COMP%]   #form-filtros[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{max-width:100%;padding:5px}#main-publicaciones[_ngcontent-%COMP%]   #form-filtros[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0 5px;height:36px;font-size:12px}#main-publicaciones[_ngcontent-%COMP%]   #form-filtros.localidad-row[_ngcontent-%COMP%]{grid-template-columns:2fr 1fr!important}#main-publicaciones[_ngcontent-%COMP%]   .floating-button-container[_ngcontent-%COMP%]{position:fixed;right:25px;bottom:40px;z-index:999}[_nghost-%COMP%]     .mdc-evolution-chip-set__chips{max-width:100%}[_nghost-%COMP%]     .mat-mdc-standard-chip .mdc-evolution-chip__cell--primary, [_nghost-%COMP%]     .mat-mdc-standard-chip .mdc-evolution-chip__action--primary, [_nghost-%COMP%]     .mat-mdc-standard-chip .mat-mdc-chip-action-label{overflow:hidden}@media (min-width: 0px) and (max-width: 768px){#main-publicaciones[_ngcontent-%COMP%]{grid-template-columns:1fr!important}}"]}),n})()}];let K=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({imports:[m.Bz.forChild(q),m.Bz]}),n})();var V=a(9433),z=a(9499),X=a(4466);let W=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=i.oAB({type:n}),n.\u0275inj=i.cJS({imports:[d.ez,K,V.q,r.IJ,z.O,X.m]}),n})()}}]);