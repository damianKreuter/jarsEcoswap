"use strict";(self.webpackChunkapp_eco_swap=self.webpackChunkapp_eco_swap||[]).push([[841],{9499:(M,m,n)=>{n.d(m,{O:()=>P});var r=n(4755),p=n(7870),d=n(9401),f=n(3148),v=n(4466),g=n(2223);let P=(()=>{class o{}return o.\u0275fac=function(s){return new(s||o)},o.\u0275mod=g.oAB({type:o}),o.\u0275inj=g.cJS({imports:[r.ez,p.q,f.IJ,d.u5,d.UX,v.m]}),o})()},8841:(M,m,n)=>{n.r(m),n.d(m,{PublicacionesModule:()=>io});var r=n(4755),p=n(1531),d=n(3276),f=n(8675),v=n(4004),g=n(5226),P=n.n(g),o=n(2223),b=n(4377),s=n(9401),S=n(4893),Z=n(3073),I=n(2777),O=n(5500);let F=(()=>{class t{constructor(i){this.backendService=i}getMyCompras(){return this.backendService.get("URImsUsuarios","api/misCompras")}}return t.\u0275fac=function(i){return new(i||t)(o.LFG(O.k))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var x=n(9114),L=n(430),y=n(9609),U=n(1728),J=n(787),E=n(1217),T=n(8995),h=n(6996),w=n(3649),u=n(1049),N=n(7876),z=n(4984),B=n(8719);const R=["localidadInput"];function Q(t,c){if(1&t){const i=o.EpF();o.TgZ(0,"mat-chip-row",24),o.NdJ("removed",function(){const l=o.CHM(i).$implicit,C=o.oxw(2);return o.KtG(C.remove(l))}),o._uU(1),o.TgZ(2,"button",25)(3,"mat-icon"),o._uU(4,"cancel"),o.qZA()()()}if(2&t){const i=c.$implicit;o.xp6(1),o.hij(" ",i," "),o.xp6(1),o.uIk("aria-label","eliminar "+i)}}function G(t,c){if(1&t&&(o.TgZ(0,"mat-option",26),o._uU(1),o.qZA()),2&t){const i=c.$implicit;o.Q6J("value",i),o.xp6(1),o.hij(" ",i," ")}}function Y(t,c){if(1&t&&(o.TgZ(0,"mat-option",26),o._uU(1),o.qZA()),2&t){const i=c.$implicit;o.Q6J("value",i.nombre),o.xp6(1),o.hij(" ",i.descripcion," ")}}function D(t,c){if(1&t){const i=o.EpF();o.TgZ(0,"mat-accordion")(1,"mat-expansion-panel",7)(2,"mat-expansion-panel-header")(3,"mat-panel-title"),o._uU(4," B\xfasqueda avanzada "),o.qZA(),o.TgZ(5,"mat-panel-description")(6,"div",8)(7,"span"),o._uU(8,"Filtr\xe1 las publicaciones!"),o.qZA()()()(),o.TgZ(9,"form",9)(10,"mat-form-field",10)(11,"mat-label"),o._uU(12,"Localidades"),o.qZA(),o.TgZ(13,"mat-chip-grid",11,12),o.YNc(15,Q,5,2,"mat-chip-row",13),o.TgZ(16,"input",14,15),o.NdJ("matChipInputTokenEnd",function(e){o.CHM(i);const l=o.oxw();return o.KtG(l.add(e))}),o.qZA()(),o.TgZ(18,"mat-autocomplete",16,17),o.NdJ("optionSelected",function(e){o.CHM(i);const l=o.oxw();return o.KtG(l.selected(e))}),o.YNc(20,G,2,2,"mat-option",18),o.ALo(21,"async"),o.qZA()(),o.TgZ(22,"mat-form-field",19)(23,"mat-label"),o._uU(24,"Tipo del Producto"),o.qZA(),o.TgZ(25,"mat-select",20),o.YNc(26,Y,2,2,"mat-option",18),o.qZA()(),o.TgZ(27,"div",21)(28,"button",22),o.NdJ("click",function(){o.CHM(i);const e=o.oxw();return o.KtG(e.filtrarPublicaciones())}),o._uU(29,"FILTRAR"),o.qZA(),o.TgZ(30,"button",23),o.NdJ("click",function(){o.CHM(i);const e=o.oxw();return o.KtG(e.limpiarFiltros())}),o._uU(31,"LIMPIAR"),o.qZA()()()()()}if(2&t){const i=o.MAs(14),a=o.MAs(19),e=o.oxw();o.xp6(9),o.Q6J("formGroup",e.formFiltros),o.xp6(6),o.Q6J("ngForOf",e.localidades),o.xp6(1),o.Q6J("matChipInputFor",i)("matAutocomplete",a),o.xp6(4),o.Q6J("ngForOf",o.lcZ(21,6,e.filteredLocalidades)),o.xp6(6),o.Q6J("ngForOf",e.tipos_productos)}}function H(t,c){1&t&&(o.TgZ(0,"div",21),o._uU(1,"No hay publicaciones para mostrar"),o.qZA())}const K=function(){return[5,10,25]};function j(t,c){if(1&t){const i=o.EpF();o.TgZ(0,"mat-paginator",31,32),o.NdJ("page",function(e){o.CHM(i);const l=o.oxw(2);return o.KtG(l.changePage(e))}),o.qZA()}if(2&t){const i=o.oxw(2);o.Q6J("pageSizeOptions",o.DdM(4,K))("pageSize",i.pageSize)("showFirstLastButtons",!0)("length",i.publicacionesToShow.length)}}function W(t,c){if(1&t&&(o.TgZ(0,"div",27),o.YNc(1,H,2,0,"div",28),o.TgZ(2,"div"),o._UZ(3,"app-deck-publicaciones",29),o.YNc(4,j,2,5,"mat-paginator",30),o.qZA()()),2&t){const i=o.oxw();o.xp6(1),o.Q6J("ngIf",0==i.publicacionesToShow.length),o.xp6(2),o.Q6J("publicacionesToShow",i.paginatedPublicaciones)("origin","myPublicaciones"==i.origin?"mis-publicaciones":"publicaciones"),o.xp6(1),o.Q6J("ngIf",i.publicacionesToShow.length>0)}}const V=[{path:"",component:(()=>{class t{constructor(i,a,e,l,C,to,ao){this.router=i,this.auth=a,this.fb=e,this.productosService=l,this.showErrorService=C,this.truequesService=to,this.comprasService=ao,this.origin="all",this.tipos_productos=[],this.loading=!1,this.publicacionesToShow=[],this.paginatedPublicaciones=[],this.pageSize=5,this.localidades=[],this.allLocalidades=[],this.formFiltros=e.group({fundacion:[""],localidad:[""],tipoProducto:[""]}),"/mis-publicaciones"==i.url&&(this.origin="myPublicaciones"),"/mis-compras"==i.url&&(this.origin="myCompras"),this.filteredLocalidades=this.formFiltros.controls.localidad.valueChanges.pipe((0,f.O)(""),(0,v.U)(_=>_?this._filterLocalidad(_):this.allLocalidades.slice())),this.getTiposProductos(),this.getLocalidades(),this.filtrarPublicaciones()}addPublicacion(){this.auth.isUserLoggedIn?this.router.navigate(["form-publicacion"]):P().fire({title:"\xa1Necesit\xe1s una cuenta!",text:"Para poder crear una publicaci\xf3n, ten\xe9s que usar tu cuenta.",icon:"warning",confirmButtonText:"Iniciar sesi\xf3n",showCancelButton:!0,cancelButtonText:"Cancelar"}).then(({isConfirmed:i})=>{i&&this.router.navigate(["login"])})}getTiposProductos(){this.productosService.getTiposProductos().subscribe({next:i=>{this.tipos_productos=i},error:i=>{console.error("error",i)}})}filtrarPublicaciones(){if("all"==this.origin){this.filtros={};const i=this.formFiltros.controls.tipoProducto.value;this.localidades.length>0&&(this.filtros.localidades=this.localidades),i&&(this.filtros.tipoProducto=i),this.truequesService.getPublicaciones(this.filtros).subscribe({next:a=>{console.log(a),this.publicacionesToShow=a,this.publicacionesToShow.map(e=>{e.parsedImagenes=e.imagenes.split("|")}),this.paginatedPublicaciones=this.publicacionesToShow.slice(0,this.pageSize)}})}else"myPublicaciones"==this.origin?this.truequesService.getMisPublicaciones().subscribe({next:i=>{console.log(i),this.publicacionesToShow=i,this.publicacionesToShow.map(a=>{a.parsedImagenes=a.imagenes.split("|")}),this.paginatedPublicaciones=this.publicacionesToShow.slice(0,this.pageSize)}}):this.comprasService.getMyCompras().subscribe({next:i=>{console.log(i),this.publicacionesToShow=i,this.publicacionesToShow.map(a=>{a.parsedImagenes=a.imagenes.split("|")})}})}limpiarFiltros(){this.formFiltros.reset(),this.localidades=[],this.filtrarPublicaciones()}changePage(i){const a=i.pageIndex*i.pageSize;this.paginatedPublicaciones=this.publicacionesToShow.slice(a,a+i.pageSize)}getLocalidades(){fetch("https://apis.datos.gob.ar/georef/api/localidades?orden=id&provincia=02&max=50&campos=nombre").then(a=>a.json()).then(a=>{for(const e of a.localidades)this.allLocalidades.push(e.nombre)}).catch(a=>console.error(a))}add(i){const a=(i.value||"").trim();a&&this.allLocalidades.some(e=>e.toUpperCase()==a.toUpperCase())&&this.localidades.push(a),i.chipInput.clear(),this.formFiltros.controls.localidad.setValue(null)}remove(i){const a=this.localidades.indexOf(i);a>=0&&this.localidades.splice(a,1)}selected(i){this.localidades.push(i.option.viewValue),this.localidadInput.nativeElement.value="",this.formFiltros.controls.localidad.setValue(null)}_filterLocalidad(i){const a=i.toLowerCase();return this.allLocalidades.filter(e=>e.toLowerCase().includes(a))}}return t.\u0275fac=function(i){return new(i||t)(o.Y36(p.F0),o.Y36(b.e),o.Y36(s.qu),o.Y36(S.k),o.Y36(Z.x),o.Y36(I.x),o.Y36(F))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-trueque"]],viewQuery:function(i,a){if(1&i&&(o.Gf(d.NW,5),o.Gf(R,5)),2&i){let e;o.iGM(e=o.CRH())&&(a.paginator=e.first),o.iGM(e=o.CRH())&&(a.localidadInput=e.first)}},decls:9,vars:4,consts:[[3,"title"],["id","main-publicaciones",1,"app-main-div"],[4,"ngIf"],[3,"loading"],["class","row",4,"ngIf"],[1,"floating-button-container"],["mat-fab","","color","primary","aria-label","Agregar Publicaci\xf3n","matTooltip","Agregar Publicaci\xf3n","matTooltipPosition","before",3,"click"],[2,"border-radius","15px"],[2,"display","flex","justify-content","flex-end","width","100%","align-items","center"],["id","form-filtros",3,"formGroup"],["appearance","outline",1,"example-chip-list"],["aria-label","Localidad"],["chipGrid",""],[3,"removed",4,"ngFor","ngForOf"],["placeholder","Localidad...","formControlName","localidad","matInput","",3,"matChipInputFor","matAutocomplete","matChipInputTokenEnd"],["localidadInput",""],[3,"optionSelected"],["autoLocalidad","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline"],["formControlName","tipoProducto","panelClass","example-panel"],[2,"text-align","center"],["mat-fab","","extended","","color","primary",3,"click"],["mat-fab","","extended","",2,"background-color","white",3,"click"],[3,"removed"],["matChipRemove",""],[3,"value"],[1,"row"],["style","text-align: center;",4,"ngIf"],[3,"publicacionesToShow","origin"],["style","border-radius: 15px;",3,"pageSizeOptions","pageSize","showFirstLastButtons","length","page",4,"ngIf"],[2,"border-radius","15px",3,"pageSizeOptions","pageSize","showFirstLastButtons","length","page"],["paginator",""]],template:function(i,a){1&i&&(o._UZ(0,"app-header",0),o.TgZ(1,"div",1),o.YNc(2,D,32,8,"mat-accordion",2),o._UZ(3,"app-spinner",3),o.YNc(4,W,5,4,"div",4),o.TgZ(5,"div",5)(6,"button",6),o.NdJ("click",function(){return a.addPublicacion()}),o.TgZ(7,"mat-icon"),o._uU(8,"add"),o.qZA()()()()),2&i&&(o.Q6J("title","all"==a.origin?"Publicaciones":"myPublicaciones"==a.origin?"Mis Publicaciones":"Mis Compras"),o.xp6(2),o.Q6J("ngIf","all"==a.origin),o.xp6(1),o.Q6J("loading",a.loading),o.xp6(1),o.Q6J("ngIf",!a.loading))},dependencies:[r.sg,r.O5,x.KE,x.hX,L.Hw,y.Nt,U.cs,J.gD,E.ey,T.XC,T.ZL,h.RA,h.oH,h.qH,h.z3,d.NW,w.gM,u.pp,u.ib,u.yz,u.yK,u.u4,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,N.G,z.O,B.G,r.Ov],styles:["#main-publicaciones[_ngcontent-%COMP%]{padding:2%}#main-publicaciones[_ngcontent-%COMP%]   #form-filtros[_ngcontent-%COMP%]{display:flex;justify-content:space-around;flex-wrap:wrap}#main-publicaciones[_ngcontent-%COMP%]   #form-filtros[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{max-width:100%;padding:5px}#main-publicaciones[_ngcontent-%COMP%]   #form-filtros[_ngcontent-%COMP%]   mat-form-field.example-chip-list[_ngcontent-%COMP%]{width:55vh}#main-publicaciones[_ngcontent-%COMP%]   #form-filtros[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:2px}#main-publicaciones[_ngcontent-%COMP%]   .floating-button-container[_ngcontent-%COMP%]{position:fixed;right:25px;bottom:40px;z-index:999}"]}),t})()}];let X=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[p.Bz.forChild(V),p.Bz]}),t})();var $=n(7870),k=n(3148),q=n(9499),oo=n(4466);let io=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[r.ez,X,$.q,k.IJ,q.O,oo.m]}),t})()}}]);