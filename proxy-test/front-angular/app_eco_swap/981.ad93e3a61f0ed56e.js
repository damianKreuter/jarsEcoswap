"use strict";(self.webpackChunkapp_eco_swap=self.webpackChunkapp_eco_swap||[]).push([[981],{9499:(I,g,i)=>{i.d(g,{O:()=>v});var r=i(4755),m=i(7870),u=i(9401),h=i(3148),x=i(4466),C=i(2223);let v=(()=>{class o{}return o.\u0275fac=function(F){return new(F||o)},o.\u0275mod=C.oAB({type:o}),o.\u0275inj=C.cJS({imports:[r.ez,m.q,h.IJ,u.u5,u.UX,x.m]}),o})()},1981:(I,g,i)=>{i.r(g),i.d(g,{ColectasModule:()=>no});var r=i(4755),m=i(1531),u=i(8675),h=i(4004),x=i(5226),C=i.n(x),v=i(3276),o=i(2223),T=i(4377),F=i(8628),U=i(5500);const Z="URImsUsuarios";let w=(()=>{class e{constructor(t){this.backendService=t}getFundacion(t){return this.backendService.get(Z,"fundacion/"+t)}getFundaciones(){return this.backendService.get(Z,"fundaciones")}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(U.k))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var l=i(9401),O=i(4893),S=i(3073),A=i(9114),J=i(430),L=i(9609),E=i(1728),N=i(787),P=i(1217),M=i(8995),_=i(6996),Q=i(3649),f=i(1049),z=i(7876),b=i(4984);const B=["localidadInput"];function Y(e,s){if(1&e&&(o.TgZ(0,"mat-option",27),o._uU(1),o.qZA()),2&e){const t=s.$implicit;o.Q6J("value",t),o.xp6(1),o.hij(" ",t.nombre," ")}}function R(e,s){if(1&e&&(o.TgZ(0,"mat-option",27),o._uU(1),o.qZA()),2&e){const t=s.$implicit;o.Q6J("value",t.nombre),o.xp6(1),o.hij(" ",t.descripcion," ")}}function D(e,s){if(1&e){const t=o.EpF();o.TgZ(0,"mat-chip-row",28),o.NdJ("removed",function(){const c=o.CHM(t).$implicit,d=o.oxw(2);return o.KtG(d.remove(c))}),o._uU(1),o.TgZ(2,"button",29)(3,"mat-icon"),o._uU(4,"cancel"),o.qZA()()()}if(2&e){const t=s.$implicit;o.xp6(1),o.hij(" ",t," "),o.xp6(1),o.uIk("aria-label","eliminar "+t)}}function G(e,s){if(1&e&&(o.TgZ(0,"mat-option",27),o._uU(1),o.qZA()),2&e){const t=s.$implicit;o.Q6J("value",t),o.xp6(1),o.hij(" ",t," ")}}function H(e,s){if(1&e){const t=o.EpF();o.TgZ(0,"mat-accordion")(1,"mat-expansion-panel",6)(2,"mat-expansion-panel-header")(3,"mat-panel-title"),o._uU(4," B\xfasqueda avanzada "),o.qZA(),o.TgZ(5,"mat-panel-description")(6,"div",7)(7,"span"),o._uU(8,"Filtr\xe1 las colectas!"),o.qZA()()()(),o.TgZ(9,"form",8)(10,"mat-form-field",9)(11,"mat-label"),o._uU(12,"Fundaci\xf3n"),o.qZA(),o._UZ(13,"input",10),o.TgZ(14,"mat-autocomplete",11,12),o.YNc(16,Y,2,2,"mat-option",13),o.ALo(17,"async"),o.qZA()(),o.TgZ(18,"mat-form-field",14)(19,"mat-label"),o._uU(20,"Tipo del Producto"),o.qZA(),o.TgZ(21,"mat-select",15),o.YNc(22,R,2,2,"mat-option",13),o.qZA()(),o.TgZ(23,"mat-form-field",16)(24,"mat-label"),o._uU(25,"Localidades"),o.qZA(),o.TgZ(26,"mat-chip-grid",17,18),o.YNc(28,D,5,2,"mat-chip-row",19),o.TgZ(29,"input",20,21),o.NdJ("matChipInputTokenEnd",function(n){o.CHM(t);const c=o.oxw();return o.KtG(c.add(n))}),o.qZA()(),o.TgZ(31,"mat-autocomplete",22,23),o.NdJ("optionSelected",function(n){o.CHM(t);const c=o.oxw();return o.KtG(c.selected(n))}),o.YNc(33,G,2,2,"mat-option",13),o.ALo(34,"async"),o.qZA()(),o.TgZ(35,"div",24)(36,"button",25),o.NdJ("click",function(){o.CHM(t);const n=o.oxw();return o.KtG(n.filtrarColectas())}),o._uU(37,"FILTRAR"),o.qZA(),o.TgZ(38,"button",26),o.NdJ("click",function(){o.CHM(t);const n=o.oxw();return o.KtG(n.limpiarFiltros())}),o._uU(39,"LIMPIAR"),o.qZA()()()()()}if(2&e){const t=o.MAs(15),a=o.MAs(27),n=o.MAs(32),c=o.oxw();o.xp6(9),o.Q6J("formGroup",c.formFiltros),o.xp6(4),o.Q6J("matAutocomplete",t),o.xp6(1),o.Q6J("displayWith",c.displayFn),o.xp6(2),o.Q6J("ngForOf",o.lcZ(17,9,c.filteredOptions)),o.xp6(6),o.Q6J("ngForOf",c.tipos_productos),o.xp6(6),o.Q6J("ngForOf",c.localidades),o.xp6(1),o.Q6J("matChipInputFor",a)("matAutocomplete",n),o.xp6(4),o.Q6J("ngForOf",o.lcZ(34,11,c.filteredLocalidades))}}function K(e,s){1&e&&(o.TgZ(0,"div",24),o._uU(1,"No hay colectas para mostrar"),o.qZA())}function j(e,s){if(1&e&&(o.TgZ(0,"div",44),o._uU(1),o.qZA()),2&e){const t=s.$implicit;o.xp6(1),o.hij(" ",t.descripcion," ")}}function W(e,s){if(1&e){const t=o.EpF();o.TgZ(0,"div",35),o.NdJ("click",function(){const c=o.CHM(t).$implicit,d=o.oxw(2);return o.KtG(d.goToColecta(c))}),o.TgZ(1,"div",36),o._UZ(2,"img",37),o.qZA(),o.TgZ(3,"div",38)(4,"h2",39),o._uU(5),o.qZA(),o.TgZ(6,"div",40),o.YNc(7,j,2,1,"div",41),o.qZA()(),o.TgZ(8,"div",42),o._UZ(9,"img",43),o.TgZ(10,"h4"),o._uU(11),o.qZA()()()}if(2&e){const t=s.$implicit;o.xp6(2),o.Q6J("src",t.imagen?t.imagen:"assets/perfiles/perfiles-24.jpg",o.LSH),o.xp6(3),o.Oqu(t.titulo),o.xp6(2),o.Q6J("ngForOf",t.productos),o.xp6(4),o.Oqu(t.fundacionDTO.nombre)}}const $=function(){return[5,10,25]};function V(e,s){if(1&e){const t=o.EpF();o.TgZ(0,"mat-paginator",45,46),o.NdJ("page",function(n){o.CHM(t);const c=o.oxw(2);return o.KtG(c.changePage(n))}),o.qZA()}if(2&e){const t=o.oxw(2);o.Q6J("pageSizeOptions",o.DdM(4,$))("pageSize",t.pageSize)("showFirstLastButtons",!0)("length",t.showColectas.length)}}function X(e,s){if(1&e&&(o.TgZ(0,"div",30),o.YNc(1,K,2,0,"div",31),o.TgZ(2,"div")(3,"div",32),o.YNc(4,W,12,4,"div",33),o.YNc(5,V,2,5,"mat-paginator",34),o.qZA()()()),2&e){const t=o.oxw();o.xp6(1),o.Q6J("ngIf",0==t.showColectas.length),o.xp6(3),o.Q6J("ngForOf",t.paginatedColectas),o.xp6(1),o.Q6J("ngIf",t.showColectas.length>0)}}function q(e,s){if(1&e){const t=o.EpF();o.TgZ(0,"div",47)(1,"button",48),o.NdJ("click",function(){o.CHM(t);const n=o.oxw();return o.KtG(n.addColecta())}),o.TgZ(2,"mat-icon"),o._uU(3,"add"),o.qZA()()()}}const k=[{path:"",component:(()=>{class e{constructor(t,a,n,c,d,so,co){this.router=t,this.auth=a,this.donacionesService=n,this.fundacionesService=c,this.fb=d,this.productosService=so,this.showErrorService=co,this.colectas=[],this.isMyColectas=!1,this.showColectas=[],this.paginatedColectas=[],this.loading=!0,this.tipos_productos=[],this.optionsFundaciones=[],this.filtros={},this.pageSize=10,this.localidades=[],this.allLocalidades=[],"/mis-colectas"==t.url&&(this.isMyColectas=!0),this.formFiltros=d.group({fundacion:[""],localidad:[""],tipoProducto:[""]}),this.filteredOptions=this.formFiltros.controls.fundacion.valueChanges.pipe((0,u.O)(""),(0,h.U)(p=>{const y="string"==typeof p?p:p?.nombre;return y?this._filter(y):this.optionsFundaciones.slice()})),this.userData={isSwapper:a.isUserSwapper()},this.filteredLocalidades=this.formFiltros.controls.localidad.valueChanges.pipe((0,u.O)(""),(0,h.U)(p=>p?this._filterLocalidad(p):this.allLocalidades.slice()))}ngOnInit(){this.getFundaciones(),this.getTiposProductos(),this.getLocalidades(),this.filtrarColectas()}filtrarColectas(){if(this.loading=!0,this.isMyColectas)this.donacionesService.getMisColectas().subscribe({next:t=>{this.colectas=t,this.showColectas=this.colectas.slice(0,this.pageSize),this.showColectas.map(a=>{a.imagen=this.donacionesService.getImagen(a.imagen)}),this.paginatedColectas=this.showColectas.slice(0,this.pageSize),this.loading=!1},error:t=>{console.log("error mis colectas",t),this.loading=!1}});else{this.filtros={};const t=this.formFiltros.controls.fundacion.value?this.formFiltros.controls.fundacion.value.idFundacion:void 0,a=this.formFiltros.controls.tipoProducto.value;t&&(this.filtros.idFundacion=t),this.localidades.length>0&&(this.filtros.localidades=this.localidades),a&&(this.filtros.tipoProducto=a),console.log("filtros",this.filtros,this.localidades),this.donacionesService.getAllColectas(this.filtros).subscribe({next:n=>{this.colectas=n,this.showColectas=this.colectas,this.showColectas.map(c=>{c.imagen=this.donacionesService.getImagen(c.imagen)}),this.paginatedColectas=this.showColectas.slice(0,this.pageSize),this.loading=!1},error:n=>{console.log("error all colectas",n),this.loading=!1}})}}addColecta(){this.auth.isUserLoggedIn?this.router.navigateByUrl("form-colecta"):C().fire({title:"\xa1Necesit\xe1s una cuenta!",text:"Para poder crear una colecta, ten\xe9s que usar la cuenta de una fundaci\xf3n.",icon:"warning",confirmButtonText:"Iniciar sesi\xf3n",showCancelButton:!0,cancelButtonText:"Cancelar"}).then(({isConfirmed:t})=>{t&&this.router.navigate(["login"])})}getFundaciones(){this.fundacionesService.getFundaciones().subscribe(t=>{console.log(t),this.optionsFundaciones=t})}getTiposProductos(){this.productosService.getTiposProductos().subscribe({next:t=>{console.log("productos",t),this.tipos_productos=t},error:t=>{console.error("error",t)},complete:()=>console.info("complete")})}getLocalidades(){fetch("https://apis.datos.gob.ar/georef/api/localidades?orden=id&provincia=02&max=50&campos=nombre").then(a=>a.json()).then(a=>{for(const n of a.localidades)this.allLocalidades.push(n.nombre)}).catch(a=>console.error(a))}limpiarFiltros(){this.formFiltros.reset(),this.localidades=[],this.filtrarColectas()}displayFn(t){return t&&t.nombre?t.nombre:""}_filter(t){const a=t.toLowerCase();return this.optionsFundaciones.filter(n=>n.nombre.toLowerCase().includes(a))}goToColecta(t){this.router.navigateByUrl("colecta/"+t.idColecta)}changePage(t){const a=t.pageIndex*t.pageSize;this.paginatedColectas=this.showColectas.slice(a,a+t.pageSize)}add(t){const a=(t.value||"").trim();a&&this.allLocalidades.some(n=>n.toUpperCase()==a.toUpperCase())&&this.localidades.push(a),t.chipInput.clear(),this.formFiltros.controls.localidad.setValue(null)}remove(t){const a=this.localidades.indexOf(t);a>=0&&this.localidades.splice(a,1)}selected(t){this.localidades.push(t.option.viewValue),this.localidadInput.nativeElement.value="",this.formFiltros.controls.localidad.setValue(null)}_filterLocalidad(t){const a=t.toLowerCase();return this.allLocalidades.filter(n=>n.toLowerCase().includes(a))}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(m.F0),o.Y36(T.e),o.Y36(F.M),o.Y36(w),o.Y36(l.qu),o.Y36(O.k),o.Y36(S.x))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-colectas"]],viewQuery:function(t,a){if(1&t&&(o.Gf(v.NW,5),o.Gf(B,5)),2&t){let n;o.iGM(n=o.CRH())&&(a.paginator=n.first),o.iGM(n=o.CRH())&&(a.localidadInput=n.first)}},decls:6,vars:5,consts:[[3,"title"],["id","main-donaciones",1,"app-main-div"],[4,"ngIf"],[3,"loading"],["class","row",4,"ngIf"],["class","floating-button-container",4,"ngIf"],[2,"border-radius","15px"],[2,"display","flex","justify-content","flex-end","width","100%","align-items","center"],["id","form-filtros",3,"formGroup"],["appearance","outline",1,"example-full-width"],["type","text","matInput","","formControlName","fundacion",2,"border","1px solid red",3,"matAutocomplete"],[3,"displayWith"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline"],["formControlName","tipoProducto","panelClass","example-panel"],["appearance","outline",1,"example-chip-list"],["aria-label","Localidad"],["chipGrid",""],[3,"removed",4,"ngFor","ngForOf"],["placeholder","Localidad...","formControlName","localidad","matInput","",3,"matChipInputFor","matAutocomplete","matChipInputTokenEnd"],["localidadInput",""],[3,"optionSelected"],["autoLocalidad","matAutocomplete"],[2,"text-align","center"],["mat-fab","","extended","","color","primary",3,"click"],["mat-fab","","extended","",2,"background-color","white",3,"click"],[3,"value"],[3,"removed"],["matChipRemove",""],[1,"row"],["style","text-align: center;",4,"ngIf"],[1,"card-deck"],["class","card row",3,"click",4,"ngFor","ngForOf"],["style","border-radius: 15px;",3,"pageSizeOptions","pageSize","showFirstLastButtons","length","page",4,"ngIf"],[1,"card","row",3,"click"],[1,"col-sm-4",2,"display","flex","justify-content","center"],[1,"card-img",3,"src"],[1,"card-body","col-sm-6"],[1,"card-title"],[1,"productos"],["class","producto",4,"ngFor","ngForOf"],[1,"card-fundacion","col-sm-2"],["src","assets/perfiles/perfiles-24.jpg",1,"img-fundacion"],[1,"producto"],[2,"border-radius","15px",3,"pageSizeOptions","pageSize","showFirstLastButtons","length","page"],["paginator",""],[1,"floating-button-container"],["mat-fab","","color","primary","aria-label","Agregar Colecta","matTooltip","Agregar Colecta","matTooltipPosition","before",3,"click"]],template:function(t,a){1&t&&(o._UZ(0,"app-header",0),o.TgZ(1,"div",1),o.YNc(2,H,40,13,"mat-accordion",2),o._UZ(3,"app-spinner",3),o.YNc(4,X,6,3,"div",4),o.YNc(5,q,4,0,"div",5),o.qZA()),2&t&&(o.Q6J("title",a.isMyColectas?"Mis Colectas":"Colectas"),o.xp6(2),o.Q6J("ngIf",!a.isMyColectas),o.xp6(1),o.Q6J("loading",a.loading),o.xp6(1),o.Q6J("ngIf",!a.loading),o.xp6(1),o.Q6J("ngIf",!a.userData.isSwapper))},dependencies:[r.sg,r.O5,A.KE,A.hX,J.Hw,L.Nt,E.cs,N.gD,P.ey,M.XC,M.ZL,_.RA,_.oH,_.qH,_.z3,v.NW,Q.gM,f.pp,f.ib,f.yz,f.yK,f.u4,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,z.G,b.O,r.Ov],styles:["#main-donaciones{padding:2%}#main-donaciones #form-filtros{display:flex;justify-content:space-around;flex-wrap:wrap}#main-donaciones #form-filtros mat-form-field{max-width:100%;padding:5px}#main-donaciones #form-filtros mat-form-field.example-chip-list{width:55vh}#main-donaciones #form-filtros button{margin:2px}#main-donaciones #form-filtros.localidad-row{grid-template-columns:2fr 1fr!important}#main-donaciones .card{margin:5px;display:flex;flex-direction:row;align-items:center}#main-donaciones .card:hover{cursor:pointer}#main-donaciones .card .card-img{max-height:160px;margin:20px;width:auto;max-width:100%}#main-donaciones .card .productos{display:flex;flex-direction:row;flex-wrap:wrap}#main-donaciones .card .productos .producto{margin:5px 10px;min-width:100px}#main-donaciones .card .card-fundacion{text-align:center}#main-donaciones .card .card-fundacion .img-fundacion{width:30px}#main-donaciones .floating-button-container{position:fixed;right:25px;bottom:40px;z-index:999}\n"],encapsulation:2}),e})()}];let oo=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[m.Bz.forChild(k),m.Bz]}),e})();var to=i(7870),eo=i(3148),ao=i(9499),io=i(4466);let no=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[r.ez,oo,to.q,eo.IJ,ao.O,io.m,l.u5,l.UX]}),e})()}}]);