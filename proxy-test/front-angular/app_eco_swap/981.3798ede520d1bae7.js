"use strict";(self.webpackChunkapp_eco_swap=self.webpackChunkapp_eco_swap||[]).push([[981],{9499:(O,C,e)=>{e.d(C,{O:()=>l});var p=e(4755),m=e(4766),h=e(9401),_=e(3148),r=e(4466),v=e(2223);let l=(()=>{class t{}return t.\u0275fac=function(u){return new(u||t)},t.\u0275mod=v.oAB({type:t}),t.\u0275inj=v.cJS({imports:[p.ez,m.q,_.IJ,h.u5,h.UX,r.m]}),t})()},1981:(O,C,e)=>{e.r(C),e.d(C,{ColectasModule:()=>q});var p=e(4755),m=e(1531),h=e(8675),_=e(4004),r=e(5226),v=e.n(r),l=e(3276),t=e(2223),a=e(4377),u=e(8628),M=e(5500);const P="URImsUsuarios";let S=(()=>{class n{constructor(o){this.backendService=o}getFundacion(o){return this.backendService.get(P,"fundacion/"+o)}getFundaciones(){return this.backendService.get(P,"fundaciones")}}return n.\u0275fac=function(o){return new(o||n)(t.LFG(M.k))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var g=e(9401),A=e(4893),y=e(3073),T=e(9114),U=e(430),I=e(9609),E=e(1728),D=e(787),J=e(1217),F=e(8995),w=e(3649),L=e(7876),b=e(4984);function N(n,c){if(1&n&&(t.TgZ(0,"mat-option",19),t._uU(1),t.qZA()),2&n){const o=c.$implicit;t.Q6J("value",o),t.xp6(1),t.hij(" ",o.nombre," ")}}function B(n,c){if(1&n&&(t.TgZ(0,"mat-option",19),t._uU(1),t.qZA()),2&n){const o=c.$implicit;t.Q6J("value",o.nombre),t.xp6(1),t.hij(" ",o.descripcion," ")}}function R(n,c){if(1&n){const o=t.EpF();t.TgZ(0,"form",7)(1,"mat-form-field",8)(2,"mat-label"),t._uU(3,"Fundaci\xf3n"),t.qZA(),t._UZ(4,"input",9),t.TgZ(5,"mat-autocomplete",10,11),t.YNc(7,N,2,2,"mat-option",12),t.ALo(8,"async"),t.qZA()(),t.TgZ(9,"mat-form-field",13)(10,"mat-label"),t._uU(11,"C\xf3digo Postal"),t.qZA(),t._UZ(12,"input",14),t.qZA(),t.TgZ(13,"mat-form-field",13)(14,"mat-label"),t._uU(15,"Tipo del Producto"),t.qZA(),t.TgZ(16,"mat-select",15),t.YNc(17,B,2,2,"mat-option",12),t.qZA()(),t.TgZ(18,"div",16)(19,"button",17),t.NdJ("click",function(){t.CHM(o);const s=t.oxw();return t.KtG(s.filtrarColectas())}),t._uU(20,"FILTRAR"),t.qZA(),t.TgZ(21,"button",18),t.NdJ("click",function(){t.CHM(o);const s=t.oxw();return t.KtG(s.limpiarFiltros())}),t._uU(22,"LIMPIAR"),t.qZA()()()}if(2&n){const o=t.MAs(6),i=t.oxw();t.Q6J("formGroup",i.formFiltros),t.xp6(4),t.Q6J("matAutocomplete",o),t.xp6(1),t.Q6J("displayWith",i.displayFn),t.xp6(2),t.Q6J("ngForOf",t.lcZ(8,5,i.filteredOptions)),t.xp6(10),t.Q6J("ngForOf",i.tipos_productos)}}function Q(n,c){1&n&&(t.TgZ(0,"div",16),t._uU(1,"No hay colectas para mostrar"),t.qZA())}function Y(n,c){if(1&n&&(t.TgZ(0,"div",34),t._uU(1),t.qZA()),2&n){const o=c.$implicit;t.xp6(1),t.hij(" ",o.descripcion," ")}}function z(n,c){if(1&n){const o=t.EpF();t.TgZ(0,"div",25),t.NdJ("click",function(){const d=t.CHM(o).$implicit,f=t.oxw(2);return t.KtG(f.goToColecta(d))}),t.TgZ(1,"div",26),t._UZ(2,"img",27),t.qZA(),t.TgZ(3,"div",28)(4,"h2",29),t._uU(5),t.qZA(),t.TgZ(6,"div",30),t.YNc(7,Y,2,1,"div",31),t.qZA()(),t.TgZ(8,"div",32),t._UZ(9,"img",33),t.TgZ(10,"h4"),t._uU(11),t.qZA()()()}if(2&n){const o=c.$implicit;t.xp6(2),t.Q6J("src",o.imagen?o.imagen:"assets/fundacion.png",t.LSH),t.xp6(3),t.Oqu(o.titulo),t.xp6(2),t.Q6J("ngForOf",o.productos),t.xp6(4),t.Oqu(o.fundacionDTO.nombre)}}const K=function(){return[5,10,25]};function W(n,c){if(1&n){const o=t.EpF();t.TgZ(0,"div",2),t.YNc(1,Q,2,0,"div",20),t.TgZ(2,"div")(3,"div",21),t.YNc(4,z,12,4,"div",22),t.TgZ(5,"mat-paginator",23,24),t.NdJ("page",function(s){t.CHM(o);const d=t.oxw();return t.KtG(d.changePage(s))}),t.qZA()()()()}if(2&n){const o=t.oxw();t.xp6(1),t.Q6J("ngIf",0==o.showColectas.length),t.xp6(3),t.Q6J("ngForOf",o.paginatedColectas),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(6,K))("pageSize",o.pageSize)("showFirstLastButtons",!0)("length",o.showColectas.length)}}function G(n,c){if(1&n){const o=t.EpF();t.TgZ(0,"div",35)(1,"button",36),t.NdJ("click",function(){t.CHM(o);const s=t.oxw();return t.KtG(s.addColecta())}),t.TgZ(2,"mat-icon"),t._uU(3,"add"),t.qZA()()()}}const H=[{path:"",component:(()=>{class n{constructor(o,i,s,d,f,tt,ot){this.router=o,this.auth=i,this.donacionesService=s,this.fundacionesService=d,this.fb=f,this.productosService=tt,this.showErrorService=ot,this.colectas=[],this.isMyColectas=!1,this.showColectas=[],this.paginatedColectas=[],this.loading=!0,this.tipos_productos=[],this.optionsFundaciones=[],this.filtros={},this.pageSize=10,"/mis-colectas"==o.url&&(this.isMyColectas=!0),this.formFiltros=f.group({fundacion:[""],codigoPostal:[""],tipoProducto:[""]}),this.filteredOptions=this.formFiltros.controls.fundacion.valueChanges.pipe((0,h.O)(""),(0,_.U)(x=>{const Z="string"==typeof x?x:x?.nombre;return Z?this._filter(Z):this.optionsFundaciones.slice()})),this.userData={isSwapper:i.isUserSwapper()}}ngOnInit(){this.getFundaciones(),this.getTiposProductos(),this.filtrarColectas()}filtrarColectas(){if(this.loading=!0,this.isMyColectas)this.donacionesService.getMisColectas().subscribe({next:o=>{this.colectas=o,this.showColectas=this.colectas.slice(0,this.pageSize),this.showColectas.map(i=>{i.imagen=this.donacionesService.getImagen(i.imagen)}),this.paginatedColectas=this.showColectas.slice(0,this.pageSize),this.loading=!1},error:o=>{console.log("error mis colectas",o),this.loading=!1}});else{this.filtros={};const o=this.formFiltros.controls.fundacion.value?this.formFiltros.controls.fundacion.value.idFundacion:void 0,i=this.formFiltros.controls.codigoPostal.value,s=this.formFiltros.controls.tipoProducto.value;o&&(this.filtros.idFundacion=o),i&&(this.filtros.codigoPostal=i),s&&(this.filtros.tipoProducto=s),this.donacionesService.getAllColectas(this.filtros).subscribe({next:d=>{this.colectas=d,this.showColectas=this.colectas,this.showColectas.map(f=>{f.imagen=this.donacionesService.getImagen(f.imagen)}),this.paginatedColectas=this.showColectas.slice(0,this.pageSize),this.loading=!1},error:d=>{console.log("error all colectas",d),this.loading=!1}})}}addColecta(){this.auth.isUserLoggedIn?this.router.navigateByUrl("form-colecta"):v().fire({title:"\xa1Necesit\xe1s una cuenta!",text:"Para poder crear una colecta, ten\xe9s que usar la cuenta de una fundaci\xf3n.",icon:"warning",confirmButtonText:"Iniciar sesi\xf3n",showCancelButton:!0,cancelButtonText:"Cancelar"}).then(({isConfirmed:o})=>{o&&this.router.navigate(["login"])})}getFundaciones(){this.fundacionesService.getFundaciones().subscribe(o=>{console.log(o),this.optionsFundaciones=o})}getTiposProductos(){this.productosService.getTiposProductos().subscribe({next:o=>{console.log("productos",o),this.tipos_productos=o},error:o=>{console.error("error",o)},complete:()=>console.info("complete")})}limpiarFiltros(){this.formFiltros.reset(),this.filtrarColectas()}displayFn(o){return o&&o.nombre?o.nombre:""}_filter(o){const i=o.toLowerCase();return this.optionsFundaciones.filter(s=>s.nombre.toLowerCase().includes(i))}goToColecta(o){this.router.navigateByUrl("colecta/"+o.idColecta)}changePage(o){const i=o.pageIndex*o.pageSize;this.paginatedColectas=this.showColectas.slice(i,i+o.pageSize)}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(m.F0),t.Y36(a.e),t.Y36(u.M),t.Y36(S),t.Y36(g.qu),t.Y36(A.k),t.Y36(y.x))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-colectas"]],viewQuery:function(o,i){if(1&o&&t.Gf(l.NW,5),2&o){let s;t.iGM(s=t.CRH())&&(i.paginator=s.first)}},decls:7,vars:5,consts:[[3,"title"],["id","main-donaciones",1,"app-main-div"],[1,"row"],["id","form-filtros",3,"formGroup",4,"ngIf"],[3,"loading"],["class","row",4,"ngIf"],["class","floating-button-container",4,"ngIf"],["id","form-filtros",3,"formGroup"],["appearance","outline",1,"example-full-width"],["type","text","matInput","","formControlName","fundacion",2,"border","1px solid red",3,"matAutocomplete"],[3,"displayWith"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline"],["matInput","","formControlName","codigoPostal","type","number"],["formControlName","tipoProducto","panelClass","example-panel"],[2,"text-align","center"],["mat-fab","","extended","","color","primary",3,"click"],["mat-fab","","extended","",2,"background-color","white",3,"click"],[3,"value"],["style","text-align: center;",4,"ngIf"],[1,"card-deck"],["class","card row",3,"click",4,"ngFor","ngForOf"],[2,"border-radius","15px",3,"pageSizeOptions","pageSize","showFirstLastButtons","length","page"],["paginator",""],[1,"card","row",3,"click"],[1,"col-sm-4",2,"display","flex","justify-content","center"],[1,"card-img",3,"src"],[1,"card-body","col-sm-6"],[1,"card-title"],[1,"productos"],["class","producto",4,"ngFor","ngForOf"],[1,"card-fundacion","col-sm-2"],["src","assets/fundacion.png",1,"img-fundacion"],[1,"producto"],[1,"floating-button-container"],["mat-fab","","color","primary","aria-label","Agregar Colecta","matTooltip","Agregar Colecta","matTooltipPosition","before",3,"click"]],template:function(o,i){1&o&&(t._UZ(0,"app-header",0),t.TgZ(1,"div",1)(2,"div",2),t.YNc(3,R,23,7,"form",3),t.qZA(),t._UZ(4,"app-spinner",4),t.YNc(5,W,7,7,"div",5),t.YNc(6,G,4,0,"div",6),t.qZA()),2&o&&(t.Q6J("title",i.isMyColectas?"Mis Colectas":"Colectas"),t.xp6(3),t.Q6J("ngIf",!i.isMyColectas),t.xp6(1),t.Q6J("loading",i.loading),t.xp6(1),t.Q6J("ngIf",!i.loading),t.xp6(1),t.Q6J("ngIf",!i.userData.isSwapper))},dependencies:[p.sg,p.O5,T.KE,T.hX,U.Hw,I.Nt,E.cs,D.gD,J.ey,l.NW,F.XC,F.ZL,w.gM,g._Y,g.Fj,g.wV,g.JJ,g.JL,g.sg,g.u,L.G,b.O,p.Ov],styles:["#main-donaciones[_ngcontent-%COMP%]{padding:2%}#main-donaciones[_ngcontent-%COMP%]   #form-filtros[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;justify-items:center;align-items:baseline;align-items:center}#main-donaciones[_ngcontent-%COMP%]   #form-filtros[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{max-width:100%;padding:5px}#main-donaciones[_ngcontent-%COMP%]   #form-filtros[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:2px}#main-donaciones[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{margin:5px;display:flex;flex-direction:row;align-items:center}#main-donaciones[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{cursor:pointer}#main-donaciones[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-img[_ngcontent-%COMP%]{max-height:160px;margin:20px;width:auto;max-width:100%}#main-donaciones[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .productos[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap}#main-donaciones[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .productos[_ngcontent-%COMP%]   .producto[_ngcontent-%COMP%]{margin:5px 10px;min-width:100px}#main-donaciones[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-fundacion[_ngcontent-%COMP%]{text-align:center}#main-donaciones[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-fundacion[_ngcontent-%COMP%]   .img-fundacion[_ngcontent-%COMP%]{width:30px}#main-donaciones[_ngcontent-%COMP%]   .floating-button-container[_ngcontent-%COMP%]{position:fixed;right:25px;bottom:40px}@media (min-width: 577px) and (max-width: 768px){#form-filtros[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr!important}}@media (min-width: 0px) and (max-width: 576px){#form-filtros[_ngcontent-%COMP%]{grid-template-columns:1fr!important}}"]}),n})()}];let j=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.Bz.forChild(H),m.Bz]}),n})();var $=e(4766),X=e(3148),k=e(9499),V=e(4466);let q=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.ez,j,$.q,X.IJ,k.O,V.m,l.TU]}),n})()},8628:(O,C,e)=>{e.d(C,{M:()=>v});var p=e(2340),m=e(2223),h=e(5500);const _=p.N.apiUrl+"8080/",r="URImsUsuarios";let v=(()=>{class l{constructor(a){this.backendService=a}crearColecta(a){return this.backendService.post(r,"api/colecta",a)}getAllColectas(a){return this.backendService.get(r,"api/colectas",a)}getMisColectas(){return this.backendService.get(r,"api/misColectas")}getColecta(a){return this.backendService.get(r,"api/colecta/"+a)}getDonacionesColecta(a){return this.backendService.get(r,"api/colecta/"+a+"/donaciones")}getMisDonaciones(){return this.backendService.get(r,"api/particular/misDonaciones")}crearDonacion(a,u){return this.backendService.post(r,"api/colecta/"+a+"/crearDonacion",u)}getImagen(a){return`${_}api/getImage/${a}`}cambiarEstadoDonacion(a,u,M){return this.backendService.put(r,"api/colecta/"+a+"/donaciones/"+u,M)}}return l.\u0275fac=function(a){return new(a||l)(m.LFG(h.k))},l.\u0275prov=m.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"}),l})()}}]);