"use strict";(self.webpackChunkapp_eco_swap=self.webpackChunkapp_eco_swap||[]).push([[636],{8636:(nt,h,a)=>{a.r(h),a.d(h,{ColectaModule:()=>X});var l=a(4755),g=a(1531),t=a(2223),f=a(4377),_=a(8628),O=a(3073),x=a(4893),P=a(5763),v=a(5580),T=a(7876),Z=a(4984),A=a(9229),D=a(8088),I=a(5226),p=a.n(I),y=a(430),w=a(1728),s=a(6012),U=a(3649);function b(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"mat-icon",23),t.NdJ("click",function(){t.CHM(n);const c=t.oxw(2);return t.KtG(c.showDireccion(c.colecta.fundacionDTO))}),t._uU(1,"place"),t.qZA()}}function S(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"mat-icon",23),t.NdJ("click",function(){t.CHM(n);const c=t.oxw(2);return t.KtG(c.showContactInfo(c.colecta.fundacionDTO))}),t._uU(1,"info"),t.qZA()}}function N(e,i){1&e&&(t.TgZ(0,"mat-icon",24),t._uU(1,"star"),t.qZA())}function E(e,i){1&e&&(t.TgZ(0,"mat-icon",25),t._uU(1,"star"),t.qZA())}function J(e,i){if(1&e&&(t.TgZ(0,"div",26)(1,"div"),t._uU(2),t.qZA(),t.TgZ(3,"div"),t._uU(4,"0"),t.qZA(),t.TgZ(5,"div"),t._uU(6),t.qZA(),t.TgZ(7,"div"),t._uU(8),t.qZA()()),2&e){const n=i.$implicit;t.xp6(2),t.Oqu(n.descripcion),t.xp6(4),t.Oqu(n.cantidadRecibida),t.xp6(2),t.Oqu(n.cantidadSolicitada>0?n.cantidadSolicitada:"Sin l\xedmite")}}function F(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"mat-card-actions",27)(1,"button",28),t.NdJ("click",function(){t.CHM(n);const c=t.oxw(2);return t.KtG(c.donar())}),t._uU(2,"QUIERO DONAR"),t.qZA()()}}const M=function(){return[]};function Y(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"mat-card")(1,"mat-card-header",1)(2,"div",2)(3,"div",3),t._UZ(4,"div",4),t.TgZ(5,"div")(6,"mat-card-title",5)(7,"a",6),t._uU(8),t.qZA(),t.YNc(9,b,2,0,"mat-icon",7),t.YNc(10,S,2,0,"mat-icon",7),t.qZA(),t.TgZ(11,"mat-card-subtitle"),t.YNc(12,N,2,0,"mat-icon",8),t.YNc(13,E,2,0,"mat-icon",9),t.qZA()()(),t.TgZ(14,"div",10),t._uU(15),t.qZA()()(),t.TgZ(16,"mat-card-content",11)(17,"img",12),t.NdJ("click",function(){t.CHM(n);const c=t.oxw();return t.KtG(c.zoomImage(c.colecta.imagen?c.colecta.imagen.split("/").at(-1):"assets/perfiles/perfiles-24.jpg"))}),t.qZA(),t.TgZ(18,"div")(19,"h2",13),t._uU(20),t.qZA(),t.TgZ(21,"div",14),t._uU(22),t.qZA(),t.TgZ(23,"div",15)(24,"h4",16)(25,"u"),t._uU(26,"Productos"),t.qZA(),t._uU(27,":"),t.qZA(),t.TgZ(28,"div",17),t._UZ(29,"div"),t.TgZ(30,"span",18),t._uU(31,"schedule_send"),t.qZA(),t.TgZ(32,"span",19),t._uU(33,"real_estate_agent"),t.qZA(),t.TgZ(34,"span",20),t._uU(35,"add_home"),t.qZA()(),t.YNc(36,J,9,3,"div",21),t.qZA()()(),t.YNc(37,F,3,0,"mat-card-actions",22),t.qZA()}if(2&e){const n=t.oxw();t.xp6(7),t.Q6J("href","/perfil/"+n.colecta.fundacionDTO.usuarioDTO.idUsuario,t.LSH),t.xp6(1),t.Oqu(n.colecta.fundacionDTO.nombre),t.xp6(1),t.Q6J("ngIf",n.colecta.fundacionDTO&&n.colecta.fundacionDTO.direcciones.length>0),t.xp6(1),t.Q6J("ngIf",n.colecta.fundacionDTO),t.xp6(2),t.Q6J("ngForOf",t.DdM(12,M).constructor(n.colecta.fundacionDTO.puntaje||0)),t.xp6(1),t.Q6J("ngForOf",t.DdM(13,M).constructor(5-(n.colecta.fundacionDTO.puntaje||0))),t.xp6(2),t.hij("",n.parseVigencia()," "),t.xp6(2),t.Q6J("src",n.colecta.imagen?n.getImage(n.colecta.imagen):"assets/perfiles/perfiles-24.jpg",t.LSH),t.xp6(3),t.Oqu(n.colecta.titulo),t.xp6(2),t.hij(" ",n.colecta.descripcion," "),t.xp6(14),t.Q6J("ngForOf",n.colecta.productos),t.xp6(1),t.Q6J("ngIf",!(n.userData.isLoggedIn&&!n.userData.isSwapper))}}let q=(()=>{class e{constructor(n,o,c,d,r){this.auth=n,this.router=o,this.dialog=c,this.donacionesService=d,this.datePipe=r}donar(){this.auth.isUserLoggedIn?p().fire({title:"\xa1Est\xe1s un paso m\xe1s cerca de hacer tu donaci\xf3n!",text:"Te vamos a pedir algunos datos de lo que vas a donar. Es importante que completes la informaci\xf3n requerida para que la fundaci\xf3n conozca lo que vas a donar.",icon:"info",confirmButtonText:"\xa1VAMOS!"}).then(({isConfirmed:n})=>{n&&this.colecta&&this.router.navigate(["donacion/"+this.colecta.idColecta])}):p().fire({title:"\xa1Necesit\xe1s una cuenta!",text:"Para poder donar, ten\xe9s que usar tu cuenta.",icon:"warning",confirmButtonText:"Iniciar sesi\xf3n",showCancelButton:!0,cancelButtonText:"Cancelar"}).then(({isConfirmed:n})=>{n&&this.router.navigate(["login"])})}showDireccion(n){let o=n.direcciones[0].calle+n.direcciones[0].altura||"";const d=`https://apis.datos.gob.ar/georef/api/direcciones?provincia=02&localidad=${encodeURIComponent(n.direcciones[0].localidad||"")}&direccion=${encodeURIComponent(o)}`;fetch(d).then(r=>r.json()).then(r=>{r.cantidad>0&&this.dialog.open(D.G,{maxWidth:"70vw",maxHeight:"60vh",height:"100%",width:"100%",panelClass:"full-screen-modal",data:{lat:r.direcciones[0].ubicacion.lat,lon:r.direcciones[0].ubicacion.lon}})}).catch(r=>console.error(r))}showContactInfo(n){p().fire({title:"Informaci\xf3n de la fundaci\xf3n: \n "+n.nombre,html:`\n\t\t\t<p style="font-weight: 400;"><b>Email: </b>${n.usuarioDTO.email}</p>\n\t\t\t<p style="font-weight: 400;"><b>Tel\xe9fono: </b>${n.usuarioDTO.telefono}</p>\n\t\t\t`,icon:"info"})}getImage(n){return this.donacionesService.getImagen(n)}zoomImage(n){n&&p().fire({html:`<img src="${this.getImage(n)}" style="width: 100%"/>`,showConfirmButton:!1,showCloseButton:!0})}parseVigencia(){return this.colecta?this.colecta.fechaInicio&&this.colecta.fechaFin?"Desde el "+this.datePipe.transform(this.colecta.fechaInicio,"dd/MM/yyyy")+" hasta el "+this.datePipe.transform(this.colecta.fechaFin,"dd/MM/yyyy"):this.colecta.fechaInicio?"A partir del "+this.datePipe.transform(this.colecta.fechaInicio,"dd/MM/yyyy"):"":""}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(f.e),t.Y36(g.F0),t.Y36(v.uw),t.Y36(_.M),t.Y36(l.uU))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-main-card-colecta"]],inputs:{colecta:"colecta",userData:"userData"},decls:1,vars:1,consts:[[4,"ngIf"],[2,"border-bottom","solid 1px var(--light-grey)","padding-bottom","10px"],[1,"div-header"],[1,"header-info"],["mat-card-avatar","",1,"example-header-image"],[2,"display","flex","align-items","center"],[3,"href"],["class","address",3,"click",4,"ngIf"],["color","accent",4,"ngFor","ngForOf"],["class","empty-star",4,"ngFor","ngForOf"],[2,"text-align","center"],[1,"card-content"],["mat-card-image","",1,"colecta-img",3,"src","click"],[1,"card-title"],[1,"descripcion"],[1,"productos"],[2,"margin-bottom","0"],[1,"icons"],["matTooltip","Productos en camino",1,"material-icons-outlined","scheduled"],["matTooltip","Productos recibidos",1,"material-icons-outlined","received"],["matTooltip","Productos solicitados",1,"material-icons-outlined","requested"],["class","producto",4,"ngFor","ngForOf"],["class","card-button",4,"ngIf"],[1,"address",3,"click"],["color","accent"],[1,"empty-star"],[1,"producto"],[1,"card-button"],["mat-fab","","extended","","color","accent",3,"click"]],template:function(n,o){1&n&&t.YNc(0,Y,38,14,"mat-card",0),2&n&&t.Q6J("ngIf",o.colecta&&o.colecta.fundacionDTO)},dependencies:[l.sg,l.O5,y.Hw,w.cs,s.a8,s.hq,s.kc,s.dn,s.dk,s.G2,s.$j,s.n5,U.gM],styles:[".example-header-image[_ngcontent-%COMP%]{background-image:url(perfiles-24.8b8b387b71873795.jpg);background-size:cover;margin:0 10px 0 0;width:60px;height:60px}mat-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%], mat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%], mat-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{margin:10px}.div-header[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;width:100%;justify-content:space-between;align-items:flex-end}.div-header[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]{display:flex;align-items:center}.div-header[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}.div-header[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{color:var(--dark-grey);margin-left:10px}.div-header[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]:hover{color:var(--grey-text);cursor:pointer}.card-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.card-content[_ngcontent-%COMP%]   .colecta-img[_ngcontent-%COMP%]{max-width:85%;max-height:200px;margin:auto;border-radius:10px;box-shadow:2px 2px 5px var(--dark-grey)}.card-content[_ngcontent-%COMP%]   .colecta-img[_ngcontent-%COMP%]:hover{cursor:pointer}.card-content[_ngcontent-%COMP%]   .descripcion[_ngcontent-%COMP%]{font-weight:500;font-size:16px;margin-bottom:15px}.card-content[_ngcontent-%COMP%]   .productos[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%], .card-content[_ngcontent-%COMP%]   .productos[_ngcontent-%COMP%]   .producto[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;justify-items:center;margin-bottom:10px}.card-content[_ngcontent-%COMP%]   .productos[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .card-content[_ngcontent-%COMP%]   .productos[_ngcontent-%COMP%]   .producto[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{cursor:default}.card-content[_ngcontent-%COMP%]   .productos[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .scheduled[_ngcontent-%COMP%], .card-content[_ngcontent-%COMP%]   .productos[_ngcontent-%COMP%]   .producto[_ngcontent-%COMP%]   .scheduled[_ngcontent-%COMP%]{color:var(--secondary-color)}.card-content[_ngcontent-%COMP%]   .productos[_ngcontent-%COMP%]   .icons[_ngcontent-%COMP%]   .received[_ngcontent-%COMP%], .card-content[_ngcontent-%COMP%]   .productos[_ngcontent-%COMP%]   .producto[_ngcontent-%COMP%]   .received[_ngcontent-%COMP%]{color:var(--success)}.card-button[_ngcontent-%COMP%]{align-self:center}@media (min-width: 0px) and (max-width: 576px){.card-content[_ngcontent-%COMP%], .donacion-card-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr!important}.div-header[_ngcontent-%COMP%]{grid-template-columns:1fr!important}}"]}),e})();function Q(e,i){if(1&e&&(t.TgZ(0,"div"),t._UZ(1,"app-main-card-colecta",3),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("colecta",n.colecta)("userData",n.userData)}}function j(e,i){1&e&&(t.TgZ(0,"div",6),t._uU(1," Esta colecta no tiene nuevas donaciones a\xfan! "),t.qZA())}function B(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"div")(1,"app-deck",7),t.NdJ("statusChanged",function(){t.CHM(n);const c=t.oxw(2);return t.KtG(c.getDonaciones())}),t.qZA()()}if(2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("cardList",n.donacionesAbiertas)("fullScreenWidth",!0)}}function R(e,i){if(1&e&&(t.TgZ(0,"div")(1,"h3",4),t._uU(2),t.qZA(),t.YNc(3,j,2,0,"div",5),t.YNc(4,B,2,2,"div",2),t.qZA()),2&e){const n=t.oxw();t.xp6(2),t.hij(" ",n.userData.isSwapper?"Mi donaci\xf3n":"Donaciones Pendientes"," "),t.xp6(1),t.Q6J("ngIf",0==n.donacionesAbiertas.length&&!n.loading),t.xp6(1),t.Q6J("ngIf",n.donacionesAbiertas.length>0)}}function L(e,i){1&e&&(t.TgZ(0,"div",6),t._uU(1," Esta colecta no tiene donaciones cerradas a\xfan! "),t.qZA())}function z(e,i){if(1&e&&(t.TgZ(0,"div"),t._UZ(1,"app-deck",8),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("cardList",n.donacionesCerradas)("fullScreenWidth",!0)}}function H(e,i){if(1&e&&(t.TgZ(0,"div")(1,"h3",4),t._uU(2," Donaciones Cerradas "),t.qZA(),t.YNc(3,L,2,0,"div",5),t.YNc(4,z,2,2,"div",2),t.qZA()),2&e){const n=t.oxw();t.xp6(3),t.Q6J("ngIf",0==n.donacionesToShow.length&&!n.loading),t.xp6(1),t.Q6J("ngIf",n.donacionesCerradas.length>0)}}const $=[{path:"",component:(()=>{class e{constructor(n,o,c,d,r,C,u,tt){this.route=n,this.router=o,this.auth=c,this.donacionesService=d,this.showErrorService=r,this.productoService=C,this.usuarioService=u,this.dialog=tt,this.id_colecta="",this.donaciones=[],this.loading=!0,this.donacionesToShow=[],this.donacionesAbiertas=[],this.donacionesCerradas=[],n.paramMap.subscribe(m=>{console.log(m),this.id_colecta=m.get("id_colecta")||"",this.id_colecta||r.show("Error!","No pudimos encontrar la informaci\xf3n de la colecta que seleccionaste, por favor volv\xe9 a intentarlo m\xe1s tarde.")}),this.userData={isSwapper:c.isUserSwapper(),isLoggedIn:c.isUserLoggedIn},this.userData&&this.userData.isLoggedIn&&u.getUserByID(c.getUserID()).subscribe({next:m=>{this.userInfo=m}})}ngOnInit(){this.getColecta()}getColecta(){this.donacionesService.getColecta(this.id_colecta).subscribe({next:n=>{n?(this.colecta=n,this.productoService.getProductosColecta(n.idColecta).subscribe({next:o=>{n.productos=o},error:o=>{console.log("error",o)}}),this.auth.isUserLoggedIn?this.getDonaciones():this.loading=!1):this.showErrorService.show("Error!","No se encontr\xf3 la informaci\xf3n de la colecta que seleccionaste. Intent\xe1 nuevamente m\xe1s tarde.")},error:n=>{console.log(n)}})}getDonaciones(){this.loading=!0,this.donacionesService.getDonacionesColecta(this.colecta.idColecta).subscribe({next:n=>{console.log(n),this.donaciones=n,this.donaciones.map(o=>{o.imagenes&&(o.parsedImagenes=o.imagenes.split("|"))}),this.userData.isSwapper?this.donacionesToShow=this.donaciones.filter(o=>o.particularDTO.idParticular==this.userInfo.particularDTO.idParticular):this.userData&&(this.donacionesToShow=n),this.donacionesToShow.map(o=>{o.parsedImagenes=o.imagenes.split("|")})},error:n=>{console.log("error",n)},complete:()=>{this.parseDonaciones(),this.loading=!1}})}parseDonaciones(){this.donacionesAbiertas.splice(0),this.donacionesCerradas.splice(0);for(const n of this.donacionesToShow){console.log(n);let o="";for(const[d,r]of n.caracteristicaDonacion.entries())0==d?o=r.caracteristica:o+=" - "+r.caracteristica;const c={id:n.idDonacion,imagen:n.parsedImagenes?n.parsedImagenes[0]:"no_image",titulo:n.descripcion,valorPrincipal:`${n.cantidadDonacion} unidades de ${n.producto.descripcion}`,valorSecundario:o,fecha:n.fechaDonacion,usuario:{imagen:"assets/perfiles/perfiles-17.jpg",nombre:n.particularDTO.nombre+" "+n.particularDTO.apellido,puntaje:n.particularDTO.puntaje,localidad:n.particularDTO.direcciones[0].localidad},action:"detail",buttons:this.getButtonsForCard(n),estado:n.estadoDonacion,idAuxiliar:this.colecta.idColecta};"PENDIENTE"==n.estadoDonacion?this.donacionesAbiertas.push(c):this.donacionesCerradas.push(c)}console.log(this.donacionesAbiertas,this.donacionesCerradas)}getButtonsForCard(n){return"PENDIENTE"==n.estadoDonacion?this.userData.isSwapper?[{name:"CANCELAR",icon:"close",color:"warn",status:"CANCELADA"}]:[{name:"ACEPTAR",icon:"check",color:"primary",status:"APROBADA"},{name:"RECHAZAR",icon:"close",color:"warn",status:"RECHAZADA"}]:"APROBADA"==n.estadoDonacion?[{name:"RECIBIDO",icon:"done_all",color:"primary",status:"RECIBIDA"}]:[]}isArray(n){return n.constructor===Array}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(g.gz),t.Y36(g.F0),t.Y36(f.e),t.Y36(_.M),t.Y36(O.x),t.Y36(x.k),t.Y36(P.i),t.Y36(v.uw))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-colecta"]],decls:6,vars:4,consts:[["id","main-colecta",1,"app-main-div"],[3,"loading"],[4,"ngIf"],[3,"colecta","userData"],[2,"margin","20px 0 0 5px","font-weight","bold"],["style","text-align: center;",4,"ngIf"],[2,"text-align","center"],["app","donaciones",3,"cardList","fullScreenWidth","statusChanged"],["app","donaciones",3,"cardList","fullScreenWidth"]],template:function(n,o){1&n&&(t._UZ(0,"app-header"),t.TgZ(1,"div",0),t._UZ(2,"app-spinner",1),t.YNc(3,Q,2,2,"div",2),t.YNc(4,R,5,3,"div",2),t.YNc(5,H,5,2,"div",2),t.qZA()),2&n&&(t.xp6(2),t.Q6J("loading",o.loading),t.xp6(1),t.Q6J("ngIf",o.colecta&&!o.loading),t.xp6(1),t.Q6J("ngIf",!o.loading),t.xp6(1),t.Q6J("ngIf",!o.loading))},dependencies:[l.O5,T.G,Z.O,A.o,q],styles:["#main-colecta[_ngcontent-%COMP%]{padding:2%}#main-colecta[_ngcontent-%COMP%]   .donacion-example-header-image[_ngcontent-%COMP%]{background-image:url(perfiles-17.f67e69cf999cd190.jpg);background-size:cover}#main-colecta[_ngcontent-%COMP%]   .donacion-card-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr 1fr;gap:1rem}#main-colecta[_ngcontent-%COMP%]   .donacion-card-content[_ngcontent-%COMP%]   .imagenes[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:65px;margin:5px;border-radius:5px;box-shadow:2px 2px 5px var(--dark-grey)}#main-colecta[_ngcontent-%COMP%]   .donacion-card-content[_ngcontent-%COMP%]   .donacion-status[_ngcontent-%COMP%]{display:flex;flex-direction:column}#main-colecta[_ngcontent-%COMP%]   .donacion-card-content[_ngcontent-%COMP%]   .donacion-status[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:5px auto;width:150px}#main-colecta[_ngcontent-%COMP%]   .donacion-card-content[_ngcontent-%COMP%]   .aprobada[_ngcontent-%COMP%]{color:var(--success);font-weight:500}#main-colecta[_ngcontent-%COMP%]   .donacion-card-content[_ngcontent-%COMP%]   .rechazada[_ngcontent-%COMP%]{color:var(--warn-color)}@media (min-width: 0px) and (max-width: 576px){.card-content[_ngcontent-%COMP%], .donacion-card-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr!important}.div-header[_ngcontent-%COMP%]{grid-template-columns:1fr!important}}"]}),e})()}];let G=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[g.Bz.forChild($),g.Bz]}),e})();var k=a(8796),K=a(3148),W=a(9499),V=a(4466);let X=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[l.uU],imports:[l.ez,G,k.q,K.IJ,W.O,V.m]}),e})()}}]);