"use strict";(self.webpackChunkapp_eco_swap=self.webpackChunkapp_eco_swap||[]).push([[555],{9499:(v,_,e)=>{e.d(_,{O:()=>n});var u=e(4755),g=e(9433),c=e(9401),f=e(3148),l=e(2223);let n=(()=>{class d{}return d.\u0275fac=function(a){return new(a||d)},d.\u0275mod=l.oAB({type:d}),d.\u0275inj=l.cJS({imports:[u.ez,g.q,f.IJ,c.u5,c.UX]}),d})()},9555:(v,_,e)=>{e.r(_),e.d(_,{FormDonacionModule:()=>G});var u=e(4755),g=e(1531),c=e(9401),f=e(5226),l=e.n(f),n=e(2223),d=e(8628),C=e(4377),a=e(9114),h=e(430),O=e(9609),F=e(8657),D=e(8467),P=e(1728),Z=e(787),T=e(1217),M=e(6012),A=e(3649),y=e(7876),E=e(4984);function U(t,s){if(1&t&&(n.TgZ(0,"mat-option",26),n._uU(1),n.qZA()),2&t){const o=s.$implicit;n.Q6J("value",o.idProducto),n.xp6(1),n.AsE(" ",o.descripcion," ",o.cantidadSolicitada?"(Faltan "+(o.cantidadSolicitada-o.cantidadRecibida)+")":""," ")}}function b(t,s){1&t&&(n.TgZ(0,"mat-error"),n._uU(1," Campo obligatorio "),n.qZA())}function I(t,s){1&t&&(n.TgZ(0,"mat-error"),n._uU(1," Campo obligatorio "),n.qZA())}function N(t,s){1&t&&(n.TgZ(0,"mat-error"),n._uU(1," El campo no puede contener "),n.TgZ(2,"b"),n._uU(3,";"),n.qZA()())}function J(t,s){1&t&&(n.TgZ(0,"mat-error"),n._uU(1," Campo obligatorio "),n.qZA())}function S(t,s){if(1&t){const o=n.EpF();n.TgZ(0,"div",27)(1,"mat-form-field"),n._UZ(2,"textarea",28,29),n.YNc(4,N,4,0,"mat-error",9),n.YNc(5,J,2,0,"mat-error",9),n.qZA(),n.TgZ(6,"button",30),n.NdJ("click",function(){const m=n.CHM(o).index,p=n.oxw(2);return n.KtG(p.removeCaracteristica(m))}),n.TgZ(7,"mat-icon"),n._uU(8,"delete"),n.qZA()()()}if(2&t){const o=s.$implicit;n.Q6J("formGroupName",s.index),n.xp6(4),n.Q6J("ngIf",o.get("s_descripcion").hasError("pattern")),n.xp6(1),n.Q6J("ngIf",o.get("s_descripcion").hasError("required"))}}function w(t,s){1&t&&(n.TgZ(0,"mat-error"),n._uU(1," La donaci\xf3n debe tener al menos 1 caracter\xedstica "),n.qZA())}function R(t,s){1&t&&(n.TgZ(0,"mat-error"),n._uU(1," La publicaci\xf3n debe tener al menos 1 imagen "),n.qZA())}function j(t,s){if(1&t){const o=n.EpF();n.TgZ(0,"div",31),n.NdJ("click",function(){const m=n.CHM(o).index,p=n.oxw(2);return n.KtG(p.removeImagen(m))}),n.TgZ(1,"div",32),n._UZ(2,"div",33),n.TgZ(3,"mat-icon",34),n._uU(4,"delete"),n.qZA(),n._UZ(5,"img",35),n.qZA()()}if(2&t){const o=s.$implicit;n.xp6(5),n.Q6J("src",o,n.LSH)}}function L(t,s){1&t&&n._UZ(0,"mat-spinner",36)}function Y(t,s){if(1&t){const o=n.EpF();n.TgZ(0,"mat-card",3)(1,"mat-card-header",4)(2,"mat-card-title"),n._uU(3,"Complet\xe1 los datos de tu donaci\xf3n!"),n.qZA()(),n.TgZ(4,"mat-card-content")(5,"form",5)(6,"div",6)(7,"mat-form-field")(8,"mat-label"),n._uU(9,"Producto"),n.qZA(),n.TgZ(10,"mat-select",7),n.YNc(11,U,2,3,"mat-option",8),n.qZA(),n.YNc(12,b,2,0,"mat-error",9),n.qZA()(),n.TgZ(13,"div",10)(14,"mat-form-field")(15,"mat-label"),n._uU(16,"Cantidad"),n.qZA(),n._UZ(17,"input",11),n.YNc(18,I,2,0,"mat-error",9),n.qZA()(),n.TgZ(19,"section",12)(20,"div")(21,"label",13),n._uU(22," Caracter\xedsticas "),n.TgZ(23,"mat-icon",14),n._uU(24," info "),n.qZA()()(),n.TgZ(25,"div"),n.YNc(26,S,9,3,"div",15),n.TgZ(27,"button",16),n.NdJ("click",function(){n.CHM(o);const i=n.oxw();return n.KtG(i.agregarCaracteristica())}),n.TgZ(28,"mat-icon"),n._uU(29,"add"),n.qZA(),n.TgZ(30,"label"),n._uU(31,"Agregar Caracter\xedstica"),n.qZA()(),n.YNc(32,w,2,0,"mat-error",9),n.qZA()(),n.TgZ(33,"div",10)(34,"div")(35,"label",17),n._uU(36,"Im\xe1genes"),n.qZA()(),n.TgZ(37,"button",18),n.NdJ("click",function(){n.CHM(o);const i=n.MAs(42);return n.KtG(i.click())}),n.TgZ(38,"mat-icon"),n._uU(39,"add"),n.qZA(),n._uU(40," Agregar Imagen "),n.qZA(),n.TgZ(41,"input",19,20),n.NdJ("change",function(i){n.CHM(o);const m=n.oxw();return n.KtG(m.onFileChange(i))}),n.qZA(),n.YNc(43,R,2,0,"mat-error",9),n.TgZ(44,"div",21),n.YNc(45,j,6,1,"div",22),n.qZA()()()(),n.TgZ(46,"mat-card-actions",23)(47,"button",24),n.NdJ("click",function(){n.CHM(o);const i=n.oxw();return i.confirmarDonacion(),i.donacionForm.markAllAsTouched(),n.KtG(i.donacionForm.valid)}),n._uU(48," CONFIRMAR DONACI\xd3N "),n.qZA(),n.YNc(49,L,1,0,"mat-spinner",25),n.qZA()()}if(2&t){const o=n.oxw();n.xp6(5),n.Q6J("formGroup",o.donacionForm)("ngClass",o.screenWidth>576?"big-form":"small-form"),n.xp6(6),n.Q6J("ngForOf",o.colecta.productos),n.xp6(1),n.Q6J("ngIf",o.donacionForm.get("producto").hasError("required")),n.xp6(6),n.Q6J("ngIf",o.donacionForm.get("n_cantidad").hasError("required")),n.xp6(8),n.Q6J("ngForOf",o.getCaracteristicasArray.controls),n.xp6(6),n.Q6J("ngIf",0==o.getCaracteristicasArray.length&&o.showErrors),n.xp6(11),n.Q6J("ngIf",o.donacionForm.get("file").hasError("required")&&o.showErrors),n.xp6(2),n.Q6J("ngForOf",o.images),n.xp6(2),n.Q6J("disabled",o.loadingSave),n.xp6(2),n.Q6J("ngIf",o.loadingSave)}}const k=[{path:"",component:(()=>{class t{constructor(o,r,i,m,p){this.fb=o,this.route=r,this.router=i,this.donacionesService=m,this.auth=p,this.images=[],this.loading=!0,this.showErrors=!1,this.loadingSave=!1,r.paramMap.subscribe(x=>{console.log(x),this.id_colecta=x.get("id_colecta")||""}),this.donacionForm=o.group({producto:["",c.kI.required],caracteristicas:this.fb.array([]),file:["",c.kI.required],file_source:["",c.kI.required],n_cantidad:["",c.kI.required],mensaje:[""]}),this.screenWidth=window.innerWidth>0?window.innerWidth:screen.width}ngOnInit(){this.donacionesService.getColecta(this.id_colecta).subscribe({next:o=>{this.colecta=o,this.loading=!1},error:o=>{console.log(o)}})}get getCaracteristicasArray(){return this.donacionForm.get("caracteristicas")}agregarCaracteristica(o){const r=this.fb.group({s_descripcion:["",[c.kI.pattern(/[^;]/g),c.kI.required]]});this.getCaracteristicasArray.push(r)}confirmarDonacion(){if(console.log(this.donacionForm.value),this.showErrors=!0,this.donacionForm.valid){this.loadingSave=!0;let r=[];(this.getCaracteristicasArray.value||[]).forEach(m=>{r.push(m.s_descripcion)});const i={tipoProducto:"MUEBLES",productoId:this.donacionForm.controls.producto.value,cantidadOfrecida:this.donacionForm.controls.n_cantidad.value,mensaje:this.donacionForm.controls.mensaje.value,caracteristicas:r,imagenes:this.donacionForm.controls.file_source.value};console.log("obj to send",i),this.donacionesService.crearDonacion(this.colecta.idColecta,i).subscribe({next:m=>{console.log(m),JSON.parse(JSON.stringify(m)).descripcion?(this.showMessage("Donaci\xf3n Creada!","La donacion se cre\xf3 exitosamente. Ahora te toca a vos! Llev\xe1 tu donaci\xf3n a la fundaci\xf3n para que la puedan empezar a usar.","success"),this.router.navigateByUrl("colecta/"+this.id_colecta)):this.showMessage("Ocurri\xf3 un error","No pudimos crear la donacion. Intent\xe1 nuevamente luego.","error"),this.loading=!1},error:m=>{console.log("error creando donacion",m),this.loadingSave=!1}})}}removeCaracteristica(o){this.getCaracteristicasArray.removeAt(o)}onFileChange(o){if(o.target.files&&o.target.files[0]){var r=o.target.files.length;for(let m=0;m<r;m++){var i=new FileReader;i.onload=p=>{this.images.push(p.target.result),this.donacionForm.patchValue({file_source:this.images})},i.readAsDataURL(o.target.files[m])}}}removeImagen(o){this.images.splice(o,1),this.donacionForm.patchValue({file_source:this.images})}showMessage(o,r,i){l().fire({title:o,text:r,icon:i,confirmButtonText:"\xa1OK!"})}}return t.\u0275fac=function(o){return new(o||t)(n.Y36(c.qu),n.Y36(g.gz),n.Y36(g.F0),n.Y36(d.M),n.Y36(C.e))},t.\u0275cmp=n.Xpm({type:t,selectors:[["app-donacion"]],decls:4,vars:2,consts:[["id","main-donacion",1,"app-main-div"],[3,"loading"],["id","main-card",4,"ngIf"],["id","main-card"],[2,"margin-bottom","20px"],[1,"form",3,"formGroup","ngClass"],[1,"form-input","form-col"],["formControlName","producto"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"form-col"],["matInput","","formControlName","n_cantidad","type","number"],["formArrayName","caracteristicas",1,"form-col"],[1,"caract-label"],["matTooltip","Por favor incluir medidas, estado del producto,  material del producto y cualquier caracter\xedstica que identifique a tu producto",1,"material-icons-outlined"],["class","caracteristica",3,"formGroupName",4,"ngFor","ngForOf"],["type","button","mat-fab","","extended","","color","light",2,"width","100%",3,"click"],[2,"font-weight","500","font-size","large","margin","7px 0"],["type","button","mat-fab","","extended","","color","light",3,"click"],["formControlName","file","id","file","type","file","multiple","","accept",".jpg, .jpeg, .png, .webp",1,"form-control","hidden",3,"change"],["file",""],[1,"form-col","form-imgs"],["class","show-image",3,"click",4,"ngFor","ngForOf"],[1,"buttons"],["mat-fab","","extended","","color","accent",3,"disabled","click"],["diameter","20","style","margin-left: 10px;",4,"ngIf"],[3,"value"],[1,"caracteristica",3,"formGroupName"],["matInput","","placeholder","Descripci\xf3n*","formControlName","s_descripcion","cdkTextareaAutosize",""],["autosize","cdkTextareaAutosize"],["type","button","mat-icon-button","","color","light",2,"height","60px","margin-left","5px",3,"click"],[1,"show-image",3,"click"],[1,"image"],[1,"overlay"],["color","primary",1,"update"],[1,"img-producto",3,"src"],["diameter","20",2,"margin-left","10px"]],template:function(o,r){1&o&&(n._UZ(0,"app-header"),n.TgZ(1,"div",0),n._UZ(2,"app-spinner",1),n.YNc(3,Y,50,11,"mat-card",2),n.qZA()),2&o&&(n.xp6(2),n.Q6J("loading",r.loading),n.xp6(1),n.Q6J("ngIf",!r.loading))},dependencies:[u.mk,u.sg,u.O5,a.KE,a.hX,a.TO,h.Hw,O.Nt,F.IC,D.Ou,P.RK,P.cs,Z.gD,T.ey,M.a8,M.hq,M.dn,M.dk,M.n5,A.gM,c._Y,c.Fj,c.wV,c.JJ,c.JL,c.sg,c.u,c.x0,c.CE,y.G,E.O],styles:["#main-donacion[_ngcontent-%COMP%]{padding:2%}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;row-gap:10px}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]{padding:5px;display:flex;flex-direction:column;justify-content:center}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr;padding:0}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]   .show-image[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;cursor:pointer;padding-top:5px}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]   .show-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative;width:-moz-fit-content;width:fit-content;display:flex;align-items:center;justify-content:center}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]   .show-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:hover > .overlay[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;background-color:#000;opacity:.5;transition:all 1s}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]   .show-image[_ngcontent-%COMP%]:hover   mat-icon[_ngcontent-%COMP%]{display:block}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]   .show-image[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:absolute;display:none}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]   .caract-label[_ngcontent-%COMP%]{font-weight:500;font-size:large;display:flex;align-items:center}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]   .caract-label[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--grey-text);margin:5px}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]   .caract-label[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]:hover{cursor:pointer;color:var(--dark-grey)}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]   .caracteristica[_ngcontent-%COMP%]{display:grid;grid-template-columns:5fr 1fr;align-items:center}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]   .file-label[_ngcontent-%COMP%]{background:var(--light-grey);padding:15px;border-radius:5px 5px 0 0}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]   .file-label[_ngcontent-%COMP%]:hover{cursor:pointer}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .mensaje-field[_ngcontent-%COMP%]{grid-column:1/3;display:flex;justify-content:center;align-items:center}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .mensaje-field[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:50%}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .img-producto[_ngcontent-%COMP%]{width:100px;margin:3px}#main-donacion[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .img-producto[_ngcontent-%COMP%]:hover{cursor:pointer}#main-donacion[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:20px}@media (min-width: 0px) and (max-width: 576px){.form[_ngcontent-%COMP%]{grid-template-columns:1fr!important}.mensaje-field[_ngcontent-%COMP%]{grid-column:1!important}.mensaje-field[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%!important}}.hidden[_ngcontent-%COMP%]{display:none}"]}),t})()}];let B=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[g.Bz.forChild(k),g.Bz]}),t})();var K=e(9433),Q=e(3148),z=e(9499),q=e(4466);let G=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=n.oAB({type:t}),t.\u0275inj=n.cJS({imports:[u.ez,B,K.q,Q.IJ,z.O,q.m]}),t})()},8628:(v,_,e)=>{e.d(_,{M:()=>n});var u=e(2340),g=e(2223),c=e(5500);const f=u.N.apiUrl+"8080/",l="URImsUsuarios";let n=(()=>{class d{constructor(a){this.backendService=a}crearColecta(a){return this.backendService.post(l,"api/colecta",a)}getAllColectas(a){return this.backendService.get(l,"api/colectas",a)}getMisColectas(){return this.backendService.get(l,"api/misColectas")}getColecta(a){return this.backendService.get(l,"api/colecta/"+a)}getDonacionesColecta(a){return this.backendService.get(l,"api/colecta/"+a+"/donaciones")}getMisDonaciones(){return this.backendService.get(l,"api/particular/misDonaciones")}crearDonacion(a,h){return this.backendService.post(l,"api/colecta/"+a+"/crearDonacion",h)}getImagen(a){return`${f}api/getImage/${a}`}cambiarEstadoDonacion(a,h,O){return this.backendService.put(l,"api/colecta/"+a+"/donaciones/"+h,O)}}return d.\u0275fac=function(a){return new(a||d)(g.LFG(c.k))},d.\u0275prov=g.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()}}]);