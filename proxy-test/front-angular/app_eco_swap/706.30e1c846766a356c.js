"use strict";(self.webpackChunkapp_eco_swap=self.webpackChunkapp_eco_swap||[]).push([[706],{1706:(F,m,s)=>{s.r(m),s.d(m,{DonacionesModule:()=>B});var p=s(4755),h=s(1531),f=s(8988),C=s(8088),v=s(5226),g=s.n(v),n=s(2223),D=s(5580),x=s(8628),O=s(3073),A=s(4303),M=s(430),_=s(1728),r=s(3148),b=s(7876),P=s(9229);function T(i,c){if(1&i){const e=n.EpF();n.TgZ(0,"div",16)(1,"button",17),n.NdJ("click",function(){n.CHM(e);const o=n.oxw(2);return n.KtG(o.selectDonaciones())}),n._uU(2," SELECCIONAR DONACIONES PARA ENVIAR "),n.qZA(),n.TgZ(3,"button",18),n.NdJ("click",function(){n.CHM(e);const o=n.oxw(2);return n.KtG(o.cancelSelect())}),n._uU(4," CANCELAR "),n.qZA(),n.TgZ(5,"button",19),n.NdJ("click",function(){n.CHM(e);const o=n.oxw(2);return n.KtG(o.confirmSelectedCards())}),n._uU(6," CONFIRMAR SELECCI\xd3N "),n.qZA()()}if(2&i){const e=n.oxw(2);n.xp6(1),n.Q6J("disabled",e.selectingMode),n.xp6(2),n.Q6J("disabled",!e.selectingMode),n.xp6(2),n.Q6J("disabled",!e.selectingMode||0==e.selectedCards.length)}}function w(i,c){1&i&&(n.TgZ(0,"div",20),n._uU(1," No ten\xe9s donaciones pendientes de env\xedo! "),n.qZA())}function L(i,c){if(1&i&&(n.YNc(0,T,7,3,"div",14),n.YNc(1,w,2,0,"div",15)),2&i){const e=n.oxw();n.Q6J("ngIf",e.showButtons()),n.xp6(1),n.Q6J("ngIf",!e.showButtons())}}function I(i,c){if(1&i){const e=n.EpF();n.TgZ(0,"div")(1,"app-deck",21),n.NdJ("statusChanged",function(){n.CHM(e);const o=n.oxw();return n.KtG(o.getDonaciones())})("cardSelected",function(o){n.CHM(e);const a=n.oxw();return n.KtG(a.selectCard(o))})("cardUnselected",function(o){n.CHM(e);const a=n.oxw();return n.KtG(a.unselectCard(o))}),n.qZA()()}if(2&i){const e=n.oxw();n.xp6(1),n.Q6J("cardList",e.donacionesCardList)}}function N(i,c){1&i&&(n.TgZ(0,"div",22),n._uU(1," No hay ninguna donaci\xf3n para mostrar! "),n.qZA())}const S=[{path:"",component:(()=>{class i{constructor(e,t,o,a){this.dialog=e,this.donacionesService=t,this.showErrorService=o,this.logisticaService=a,this.donaciones=[],this.donacionesCardList=[],this.loading=!1,this.selectingMode=!1,this.selectedCards=[],this.userOrders=[],this.getDonaciones(),this.screenWidth=window.innerWidth>0?window.innerWidth:screen.width}getDonaciones(){this.loading=!0,this.donaciones.splice(0),this.logisticaService.obtenerMisOrdenes("donaciones").subscribe({next:e=>{e.length>0&&(this.userOrders=e)}}),this.donacionesService.getMisDonaciones().subscribe({next:e=>{e?(this.donaciones=e,this.donaciones.map(t=>{t.idDonacion&&(t.last_status=t.estado),t.imagenes&&(t.parsedImagenes=t.imagenes.split("|"))})):this.showErrorService.show("Error!","No se encontr\xf3 la informaci\xf3n de tus donaciones. Intent\xe1 nuevamente m\xe1s tarde.")},error:e=>{console.log(e),this.loading=!1},complete:()=>this.generateCardList()})}generateCardList(){this.donacionesCardList.splice(0);const e=[];for(const t of this.donaciones){let o="";for(const[u,d]of t.caracteristicaDonacion.entries())0==u?o=d.caracteristica:o+=" - "+d.caracteristica;const a=this.userOrders.some(u=>u.productosADonarDeOrdenList.some(d=>d.idDonacion==t.idDonacion));e.push({id:t.idDonacion,imagen:t.parsedImagenes?t.parsedImagenes[0]:"no_image",titulo:t.descripcion,valorPrincipal:`${t.cantidadDonacion} unidades de ${t.producto.descripcion}`,valorSecundario:o,fecha:t.fechaDonacion,usuario:{id:t.producto.colectaDTO.fundacionDTO.usuarioDTO.idUsuario,imagen:t.producto.colectaDTO.fundacionDTO.usuarioDTO.avatar,nombre:t.producto.colectaDTO.fundacionDTO.nombre,puntaje:t.producto.colectaDTO.fundacionDTO.puntaje,localidad:t.producto.colectaDTO.fundacionDTO.direcciones[0].localidad},action:"detail",buttons:"APROBADA"==t.estadoDonacion?a?[{name:"Ver env\xedo",icon:"local_shipping",color:"info",status:"INFO"}]:[]:[{name:"CANCELAR",icon:"close",color:"warn",status:"CANCELADA"}],estado:t.estadoDonacion,idAuxiliar:t.producto.colectaDTO.idColecta}),this.loading=!1}this.donacionesCardList=e}selectDonaciones(){g().fire({title:"Configur\xe1 tu env\xedo!",text:"Seleccion\xe1 las tarjetas de tus donaciones haciendo click en ellas, vas a ver que las que seleccionen se pintar\xe1n. Record\xe1 que solo pod\xe9s seleccionar donaciones a una misma colecta. Una vez que termines, clicke\xe1 el bot\xf3n CONFIRMAR SELECCI\xd3N.",icon:"info",confirmButtonText:"\xa1VAMOS!"});const e=this.donacionesCardList;e.map(t=>{const o=this.userOrders.some(a=>a.productosADonarDeOrdenList.some(l=>l.idDonacion==t.id));"APROBADA"!=t.estado||o?t.buttons=[]:(t.action="select",t.codigo="Donaci\xf3n",t.buttons=[{name:"Agregar",icon:"add",color:"info",status:"INFO"}])}),this.donacionesCardList=e,this.selectingMode=!0}showButtons(){return!!this.donacionesCardList.some(e=>"APROBADA"==e.estado)}selectCard(e){const t=this.donacionesCardList.find(o=>o.id==e);if(t)if(0==this.selectedCards.length){this.colectaParaEnvio=t?.idAuxiliar,this.donacionesCardList.map(a=>{a.id==e&&(a.isSelected=!0)}),this.selectedCards.push(t);const o=this.donacionesCardList;o.map(a=>{a.idAuxiliar!=this.colectaParaEnvio?(a.action="detail",a.codigo=void 0,a.buttons=[]):this.selectedCards.includes(t)&&(a.buttons=[{name:"Quitar",icon:"remove",color:"info",status:"INFO"}])}),this.donacionesCardList=o}else this.colectaParaEnvio!=t.idAuxiliar&&g().fire("\xa1Colecta distinta!","No pod\xe9s seleccionar distintas colectas para un mismo env\xedo","warning")}unselectCard(e){if(this.donacionesCardList.find(o=>o.id==e))if(1==this.selectedCards.length){this.colectaParaEnvio=void 0;const o=this.donacionesCardList;o.map(a=>{const l=[...new Set(this.donaciones.map(d=>d.idDonacion))],u=this.userOrders.find(d=>d.productosADonarDeOrdenList.some(J=>l.includes(J.idDonacion)));"APROBADA"==a.estado&&0==u.length?(a.action="select",a.codigo="Donaci\xf3n",a.buttons=[{name:"Agregar",icon:"add",color:"info",status:"INFO"}]):(a.action="detail",a.codigo=void 0,a.buttons=[])}),this.donacionesCardList=o,this.selectedCards=[]}else{const o=this.selectedCards.filter(a=>a.id!=e);this.selectedCards=o}this.donacionesCardList.map(o=>{o.id==e&&(o.isSelected=!1)})}cancelSelect(){this.selectedCards=[],this.selectingMode=!1;const e=this.donacionesCardList;e.map(t=>{const o=this.userOrders.find(a=>a.productosADonarDeOrdenList.some(l=>t.id==l.idDonacion));t.action="detail",t.codigo=void 0,t.buttons="APROBADA"==t.estado&&o?[{name:"Ver env\xedo",icon:"local_shipping",color:"info",status:"INFO"}]:[]}),this.donacionesCardList=e,this.selectedCards=[]}confirmSelectedCards(){const e=this.donaciones.filter(o=>this.selectedCards.some(a=>a.id==o.idDonacion));this.dialog.open(f.o,{maxWidth:"60vw",maxHeight:"70vh",width:"100%",panelClass:"full-screen-modal",data:{cards:e}})}zoomImage(e){g().fire({html:`<img src="${e}" style="width: 100%"/>`,showConfirmButton:!1,showCloseButton:!0})}openDialog(){this.dialog.open(C.G,{maxWidth:"70vw",maxHeight:"60vh",height:"100%",width:"100%",panelClass:"full-screen-modal"})}getImage(e){return this.donacionesService.getImagen(e)}}return i.\u0275fac=function(e){return new(e||i)(n.Y36(D.uw),n.Y36(x.M),n.Y36(O.x),n.Y36(A.C))},i.\u0275cmp=n.Xpm({type:i,selectors:[["app-donaciones"]],decls:18,vars:4,consts:[["title","Mis Donaciones"],["id","main-donaciones",1,"app-main-div"],[1,"dense-3"],["ngbAccordion","",2,"min-width","255px"],["accordion","ngbAccordion"],["ngbAccordionItem","first",3,"collapsed","disabled"],["first","ngbAccordionItem"],["ngbAccordionHeader",""],["ngbAccordionButton","",1,"bg-transparent","accordion-header-button"],[2,"margin-left","10px"],["ngbAccordionCollapse",""],["ngbAccordionBody",""],[4,"ngIf"],["style","margin: 10%; text-align: center;",4,"ngIf"],["class","buttons",4,"ngIf"],["style","min-width: 210px; margin-bottom: 20px; text-align: center;",4,"ngIf"],[1,"buttons"],["mat-fab","","extended","",1,"long-text",3,"disabled","click"],["mat-fab","","extended","",2,"background-color","var(--light-grey)",3,"disabled","click"],["mat-fab","","extended","",2,"background-color","var(--info)",3,"disabled","click"],[2,"min-width","210px","margin-bottom","20px","text-align","center"],["app","donaciones",3,"cardList","statusChanged","cardSelected","cardUnselected"],[2,"margin","10%","text-align","center"]],template:function(e,t){1&e&&(n._UZ(0,"app-header",0),n.TgZ(1,"div",1)(2,"div",2)(3,"div",3,4)(5,"div",5,6)(7,"h2",7)(8,"button",8)(9,"mat-icon"),n._uU(10,"local_shipping"),n.qZA(),n.TgZ(11,"span",9),n._uU(12,"Env\xedo"),n.qZA()()(),n.TgZ(13,"div",10)(14,"div",11),n.YNc(15,L,2,2,"ng-template"),n.qZA()()()()(),n.YNc(16,I,2,1,"div",12),n.YNc(17,N,2,0,"div",13),n.qZA()),2&e&&(n.xp6(5),n.Q6J("collapsed",!1)("disabled",t.screenWidth>768),n.xp6(11),n.Q6J("ngIf",t.donacionesCardList.length>0),n.xp6(1),n.Q6J("ngIf",0==t.donacionesCardList.length))},dependencies:[p.O5,M.Hw,_.cs,r.fD,r.QQ,r.VE,r.I,r.fA,r.ud,b.G,P.o],styles:["#main-donaciones[_ngcontent-%COMP%]{padding:2%;display:grid;grid-template-columns:1fr 5fr;gap:20px}#main-donaciones[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{min-width:210px;display:flex;flex-direction:column;align-items:center;gap:15px}#main-donaciones[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]   .long-text[_ngcontent-%COMP%]{background-color:var(--info)}.donacion-example-header-image[_ngcontent-%COMP%]{background-image:url(perfiles-24.8b8b387b71873795.jpg);background-size:cover}.donacion-card-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr 1fr;gap:1rem;padding:16px}.donacion-card-content[_ngcontent-%COMP%]   .donacion-aceptada[_ngcontent-%COMP%]{font-weight:700;color:var(--success)}.donacion-card-content[_ngcontent-%COMP%]   .donacion-rechazada[_ngcontent-%COMP%]{font-weight:700;color:var(--warn)}.donacion-card-content[_ngcontent-%COMP%]   .imagenes[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:65px;margin:5px}.donacion-card-content[_ngcontent-%COMP%]   .imagenes[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{cursor:pointer}.donacion-card-content[_ngcontent-%COMP%]   .donacion-status[_ngcontent-%COMP%]{display:flex;align-items:center}.donacion-card-content[_ngcontent-%COMP%]   .donacion-status[_ngcontent-%COMP%]   mat-slide-toggle[_ngcontent-%COMP%]{margin:5px}@media (min-width: 0px) and (max-width: 768px){#main-donaciones[_ngcontent-%COMP%]{grid-template-columns:1fr!important}}@media (min-width: 769px){.long-text[_ngcontent-%COMP%]{height:-moz-fit-content;height:fit-content}}@media (min-width: 768px){.accordion-button[_ngcontent-%COMP%]:after{display:none}}"]}),i})()}];let E=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=n.oAB({type:i}),i.\u0275inj=n.cJS({imports:[h.Bz.forChild(S),h.Bz]}),i})();var Z=s(9433),R=s(9499),y=s(4466);let B=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=n.oAB({type:i}),i.\u0275inj=n.cJS({imports:[p.ez,E,Z.q,r.IJ,R.O,y.m]}),i})()}}]);