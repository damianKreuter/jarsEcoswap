"use strict";(self.webpackChunkapp_eco_swap=self.webpackChunkapp_eco_swap||[]).push([[692],{692:(at,f,c)=>{c.r(f),c.d(f,{ColectaModule:()=>ot});var u=c(4755),d=c(1531),_=c(5226),g=c.n(_),O=c(8088),t=c(2223),x=c(4377),v=c(8628),M=c(3073),P=c(4893),T=c(5763),D=c(5580),w=c(430),I=c(1728),Z=c(3276),s=c(6012),A=c(7876),S=c(4984),b=c(6247);function y(o,i){if(1&o){const n=t.EpF();t.TgZ(0,"mat-icon",21),t.NdJ("click",function(){t.CHM(n);const a=t.oxw(2);return t.KtG(a.showDireccion(a.colecta.fundacionDTO))}),t._uU(1,"place"),t.qZA()}}function F(o,i){if(1&o){const n=t.EpF();t.TgZ(0,"mat-icon",21),t.NdJ("click",function(){t.CHM(n);const a=t.oxw(2);return t.KtG(a.showContactInfo(a.colecta.fundacionDTO))}),t._uU(1,"info"),t.qZA()}}function N(o,i){1&o&&(t.TgZ(0,"mat-icon",22),t._uU(1,"star"),t.qZA())}function U(o,i){1&o&&(t.TgZ(0,"mat-icon",23),t._uU(1,"star"),t.qZA())}function E(o,i){if(1&o&&(t.TgZ(0,"div",24),t._uU(1),t.qZA()),2&o){const n=i.$implicit;t.xp6(1),t.AsE(" ",n.descripcion,": ",n.cantidadRecibida," ")}}function J(o,i){if(1&o){const n=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){t.CHM(n);const a=t.oxw(2);return t.KtG(a.donar())}),t._uU(1,"QUIERO DONAR"),t.qZA()}}const C=function(){return[]};function z(o,i){if(1&o){const n=t.EpF();t.TgZ(0,"mat-card")(1,"mat-card-header",3)(2,"div",4)(3,"div",5),t._UZ(4,"div",6),t.TgZ(5,"div")(6,"mat-card-title",7)(7,"a",8),t._uU(8),t.qZA(),t.YNc(9,y,2,0,"mat-icon",9),t.YNc(10,F,2,0,"mat-icon",9),t.qZA(),t.TgZ(11,"mat-card-subtitle"),t.YNc(12,N,2,0,"mat-icon",10),t.YNc(13,U,2,0,"mat-icon",11),t.qZA()()(),t.TgZ(14,"div",12),t._uU(15),t.qZA()()(),t.TgZ(16,"mat-card-content",13)(17,"img",14),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.zoomImage(a.colecta.imagen?a.colecta.imagen.split("/").at(-1):"assets/perfiles/perfiles-24.jpg"))}),t.qZA(),t.TgZ(18,"div")(19,"h2",15),t._uU(20),t.qZA(),t.TgZ(21,"div",16),t._uU(22),t.qZA(),t.TgZ(23,"div",17)(24,"h4")(25,"u"),t._uU(26,"Productos"),t.qZA(),t._uU(27,":"),t.qZA(),t.YNc(28,E,2,2,"div",18),t.qZA()()(),t.TgZ(29,"mat-card-actions",19),t.YNc(30,J,2,0,"button",20),t.qZA()()}if(2&o){const n=t.oxw();t.xp6(7),t.Q6J("href","/perfil/"+n.colecta.fundacionDTO.usuarioDTO.idUsuario,t.LSH),t.xp6(1),t.Oqu(n.colecta.fundacionDTO.nombre),t.xp6(1),t.Q6J("ngIf",n.colecta.fundacionDTO&&n.colecta.fundacionDTO.direcciones.length>0),t.xp6(1),t.Q6J("ngIf",n.colecta.fundacionDTO),t.xp6(2),t.Q6J("ngForOf",t.DdM(12,C).constructor(n.colecta.fundacionDTO.puntaje||0)),t.xp6(1),t.Q6J("ngForOf",t.DdM(13,C).constructor(5-(n.colecta.fundacionDTO.puntaje||0))),t.xp6(2),t.Oqu(n.parseVigencia()),t.xp6(2),t.Q6J("src",n.colecta.imagen?n.colecta.imagen:"assets/perfiles/perfiles-24.jpg",t.LSH),t.xp6(3),t.Oqu(n.colecta.titulo),t.xp6(2),t.hij(" ",n.colecta.descripcion," "),t.xp6(6),t.Q6J("ngForOf",n.colecta.productos),t.xp6(2),t.Q6J("ngIf",!(n.userData.isLoggedIn&&!n.userData.isSwapper))}}function Y(o,i){1&o&&(t.TgZ(0,"div",12),t._uU(1,"Esta colecta no tiene donaciones a\xfan!"),t.qZA())}const B=function(o){return{name:"cancelar",icon:"close",color:"warn",status:"CANCELADA",disabled:o}},Q=function(o){return[o]},q=function(o){return{name:"aceptar",icon:"check",color:"primary",status:"APROBADA",disabled:o}},L=function(o){return{name:"rechazar",icon:"close",color:"warn",status:"RECHAZADA",disabled:o}},j=function(o){return{name:"recibida",icon:"done_all",color:"primary",status:"RECIBIDA",disabled:o}},H=function(o,i,n){return[o,i,n]};function R(o,i){if(1&o&&t._UZ(0,"app-card-donacion",30),2&o){const n=i.$implicit,e=t.oxw(2);t.Q6J("donacion",n)("usuarioHeader",n.particularDTO)("buttons",e.userData.isSwapper?t.VKq(5,Q,t.VKq(3,B,"PENDIENTE"!=n.estadoDonacion)):t.kEZ(13,H,t.VKq(7,q,"PENDIENTE"!=n.estadoDonacion),t.VKq(9,L,"PENDIENTE"!=n.estadoDonacion),t.VKq(11,j,"APROBADA"!=n.estadoDonacion)))}}const K=function(){return[5,10,25]};function G(o,i){if(1&o){const n=t.EpF();t.TgZ(0,"mat-paginator",31,32),t.NdJ("page",function(a){t.CHM(n);const l=t.oxw(2);return t.KtG(l.changePage(a))}),t.qZA()}if(2&o){const n=t.oxw(2);t.Q6J("pageSizeOptions",t.DdM(4,K))("pageSize",n.pageSize)("showFirstLastButtons",!0)("length",n.donacionesToShow.length)}}function V(o,i){if(1&o&&(t.TgZ(0,"div")(1,"h3",26),t._uU(2),t.qZA(),t.YNc(3,Y,2,0,"div",27),t.YNc(4,R,1,17,"app-card-donacion",28),t.YNc(5,G,2,5,"mat-paginator",29),t.qZA()),2&o){const n=t.oxw();t.xp6(2),t.hij(" ",n.userData.isSwapper?"Mi donaci\xf3n":"Donaciones"," "),t.xp6(1),t.Q6J("ngIf",0==n.donacionesToShow.length&&!n.loading),t.xp6(1),t.Q6J("ngForOf",n.donacionesToShow),t.xp6(1),t.Q6J("ngIf",n.donacionesToShow.length>0)}}const $=[{path:"",component:(()=>{class o{constructor(n,e,a,l,r,h,p,et){this.route=n,this.router=e,this.auth=a,this.donacionesService=l,this.showErrorService=r,this.productoService=h,this.usuarioService=p,this.dialog=et,this.id_colecta="",this.donaciones=[],this.loading=!0,this.showDonaciones=!1,this.donacionesToShow=[],this.paginatedDonaciones=[],this.pageSize=5,this.buttonsCard=[],n.paramMap.subscribe(m=>{console.log(m),this.id_colecta=m.get("id_colecta")||"",this.id_colecta||r.show("Error!","No pudimos encontrar la informaci\xf3n de la colecta que seleccionaste, por favor volv\xe9 a intentarlo m\xe1s tarde.")}),this.userData={isSwapper:a.isUserSwapper(),isLoggedIn:a.isUserLoggedIn},this.userData&&this.userData.isLoggedIn&&p.getUserByID(a.getUserID()).subscribe({next:m=>{this.userInfo=m}})}ngOnInit(){this.getColecta()}getColecta(){this.donacionesService.getColecta(this.id_colecta).subscribe({next:n=>{n?(this.colecta=n,this.colecta.imagen=this.getImage(this.colecta.imagen),this.productoService.getProductosColecta(n.idColecta).subscribe({next:e=>{n.productos=e},error:e=>{console.log("error",e)}}),this.auth.isUserLoggedIn&&this.donacionesService.getDonacionesColecta(this.colecta.idColecta).subscribe({next:e=>{console.log(e),this.donaciones=e,this.donaciones.map(a=>{a.imagenes&&(a.parsedImagenes=a.imagenes.split("|"))}),this.userData.isSwapper?(this.donacionesToShow=this.donaciones.filter(a=>a.particularDTO.idParticular==this.userInfo.particularDTO.idParticular),this.showDonaciones=!0):this.userData&&(this.donacionesToShow=e,this.showDonaciones=!0),this.paginatedDonaciones=this.donacionesToShow.slice(0,this.pageSize),console.log(this.showDonaciones)},error:e=>{console.log("error",e)}}),this.loading=!1):this.showErrorService.show("Error!","No se encontr\xf3 la informaci\xf3n de la colecta que seleccionaste. Intent\xe1 nuevamente m\xe1s tarde.")},error:n=>{console.log(n)}})}donar(){this.auth.isUserLoggedIn?g().fire({title:"\xa1Est\xe1s un paso m\xe1s cerca de hacer tu donaci\xf3n!",text:"Te vamos a pedir algunos datos de lo que vas a donar. Es importante que completes la informaci\xf3n requerida para que la fundaci\xf3n conozca lo que vas a donar.",icon:"info",confirmButtonText:"\xa1VAMOS!"}).then(({isConfirmed:n})=>{n&&this.router.navigate(["donacion/"+this.id_colecta])}):g().fire({title:"\xa1Necesit\xe1s una cuenta!",text:"Para poder donar, ten\xe9s que usar tu cuenta.",icon:"warning",confirmButtonText:"Iniciar sesi\xf3n",showCancelButton:!0,cancelButtonText:"Cancelar"}).then(({isConfirmed:n})=>{n&&this.router.navigate(["login"])})}zoomImage(n){n&&g().fire({html:`<img src="${this.getImage(n)}" style="width: 100%"/>`,showConfirmButton:!1,showCloseButton:!0})}showDireccion(n){console.log(n);const l=`https://apis.datos.gob.ar/georef/api/direcciones?provincia=02&localidad=${n.direcciones[0].codigoPostal||""}\n\t\t&direccion=${encodeURIComponent(n.direcciones[0].direccion+n.direcciones[0].altura||"")}`;fetch(l).then(r=>r.json()).then(r=>{r.cantidad>0&&this.dialog.open(O.G,{maxWidth:"70vw",maxHeight:"60vh",height:"100%",width:"100%",panelClass:"full-screen-modal",data:{lat:r.direcciones[0].ubicacion.lat,lon:r.direcciones[0].ubicacion.lon}})}).catch(r=>console.error(r))}showContactInfo(n){console.log(n,this.userInfo),g().fire({title:"Informaci\xf3n de la fundaci\xf3n: \n "+n.nombre,html:`\n\t\t\t<p style="font-weight: 400;"><b>Email: </b>${n.usuarioDTO.email}</p>\n\t\t\t<p style="font-weight: 400;"><b>Tel\xe9fono: </b>${n.usuarioDTO.telefono}</p>\n\t\t\t`,icon:"info"})}getImage(n){return this.donacionesService.getImagen(n)}isArray(n){return n.constructor===Array}parseVigencia(){return this.colecta.fechaInicio&&this.colecta.fechaFin?"Desde el "+new Date(this.colecta.fechaInicio).toLocaleDateString()+" hasta el "+new Date(this.colecta.fechaFin).toLocaleDateString():this.colecta.fechaInicio?"A partir del "+new Date(this.colecta.fechaInicio).toLocaleDateString():""}changePage(n){const e=n.pageIndex*n.pageSize;this.paginatedDonaciones=this.donacionesToShow.slice(e,e+n.pageSize)}}return o.\u0275fac=function(n){return new(n||o)(t.Y36(d.gz),t.Y36(d.F0),t.Y36(x.e),t.Y36(v.M),t.Y36(M.x),t.Y36(P.k),t.Y36(T.i),t.Y36(D.uw))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-colecta"]],decls:5,vars:3,consts:[["id","main-colecta",1,"app-main-div"],[3,"loading"],[4,"ngIf"],[2,"border-bottom","solid 1px var(--light-grey)","padding-bottom","10px"],[1,"div-header"],[1,"header-info"],["mat-card-avatar","",1,"example-header-image"],[2,"display","flex","align-items","center"],[3,"href"],["class","address",3,"click",4,"ngIf"],["color","primary",4,"ngFor","ngForOf"],["class","empty-star",4,"ngFor","ngForOf"],[2,"text-align","center"],[1,"card-content"],["mat-card-image","",1,"colecta-img",3,"src","click"],[1,"card-title"],[1,"descripcion"],[1,"productos"],["class","producto",4,"ngFor","ngForOf"],[1,"card-button"],["mat-fab","","extended","","color","primary",3,"click",4,"ngIf"],[1,"address",3,"click"],["color","primary"],[1,"empty-star"],[1,"producto"],["mat-fab","","extended","","color","primary",3,"click"],[2,"margin","20px 0 0 5px","font-weight","bold"],["style","text-align: center;",4,"ngIf"],[3,"donacion","usuarioHeader","buttons",4,"ngFor","ngForOf"],["style","border-radius: 15px;",3,"pageSizeOptions","pageSize","showFirstLastButtons","length","page",4,"ngIf"],[3,"donacion","usuarioHeader","buttons"],[2,"border-radius","15px",3,"pageSizeOptions","pageSize","showFirstLastButtons","length","page"],["paginator",""]],template:function(n,e){1&n&&(t._UZ(0,"app-header"),t.TgZ(1,"div",0),t._UZ(2,"app-spinner",1),t.YNc(3,z,31,14,"mat-card",2),t.YNc(4,V,6,4,"div",2),t.qZA()),2&n&&(t.xp6(2),t.Q6J("loading",e.loading),t.xp6(1),t.Q6J("ngIf",!e.loading&&e.colecta&&e.colecta.fundacionDTO),t.xp6(1),t.Q6J("ngIf",e.showDonaciones&&!e.loading))},dependencies:[u.sg,u.O5,w.Hw,I.cs,Z.NW,s.a8,s.hq,s.kc,s.dn,s.dk,s.G2,s.$j,s.n5,A.G,S.O,b._],styles:["#main-colecta[_ngcontent-%COMP%]{padding:2%}#main-colecta[_ngcontent-%COMP%]   .example-header-image[_ngcontent-%COMP%]{background-image:url(perfiles-24.8b8b387b71873795.jpg);background-size:cover;margin:0 10px 0 0;width:60px;height:60px}#main-colecta[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%], #main-colecta[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%], #main-colecta[_ngcontent-%COMP%]   mat-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{margin:10px}#main-colecta[_ngcontent-%COMP%]   .div-header[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;width:100%;justify-content:space-between;align-items:flex-end}#main-colecta[_ngcontent-%COMP%]   .div-header[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]{display:flex;align-items:center}#main-colecta[_ngcontent-%COMP%]   .div-header[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}#main-colecta[_ngcontent-%COMP%]   .div-header[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]{color:var(--dark-grey);margin-left:10px}#main-colecta[_ngcontent-%COMP%]   .div-header[_ngcontent-%COMP%]   .header-info[_ngcontent-%COMP%]   .address[_ngcontent-%COMP%]:hover{color:var(--grey-text);cursor:pointer}#main-colecta[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}#main-colecta[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .colecta-img[_ngcontent-%COMP%]{max-width:40%;margin:auto;border-radius:10px;box-shadow:2px 2px 5px var(--dark-grey)}#main-colecta[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .colecta-img[_ngcontent-%COMP%]:hover{cursor:pointer}#main-colecta[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]   .descripcion[_ngcontent-%COMP%]{font-weight:500;font-size:16px;margin-bottom:15px}#main-colecta[_ngcontent-%COMP%]   .card-button[_ngcontent-%COMP%]{align-self:center}#main-colecta[_ngcontent-%COMP%]   .donacion-example-header-image[_ngcontent-%COMP%]{background-image:url(perfiles-17.f67e69cf999cd190.jpg);background-size:cover}#main-colecta[_ngcontent-%COMP%]   .donacion-card-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr 1fr;gap:1rem}#main-colecta[_ngcontent-%COMP%]   .donacion-card-content[_ngcontent-%COMP%]   .imagenes[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:65px;margin:5px;border-radius:5px;box-shadow:2px 2px 5px var(--dark-grey)}#main-colecta[_ngcontent-%COMP%]   .donacion-card-content[_ngcontent-%COMP%]   .donacion-status[_ngcontent-%COMP%]{display:flex;flex-direction:column}#main-colecta[_ngcontent-%COMP%]   .donacion-card-content[_ngcontent-%COMP%]   .donacion-status[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:5px auto;width:150px}#main-colecta[_ngcontent-%COMP%]   .donacion-card-content[_ngcontent-%COMP%]   .aprobada[_ngcontent-%COMP%]{color:var(--primary-color);font-weight:500}#main-colecta[_ngcontent-%COMP%]   .donacion-card-content[_ngcontent-%COMP%]   .rechazada[_ngcontent-%COMP%]{color:var(--warn-color)}@media (min-width: 0px) and (max-width: 576px){.card-content[_ngcontent-%COMP%], .donacion-card-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr!important}.div-header[_ngcontent-%COMP%]{grid-template-columns:1fr!important}}"]}),o})()}];let k=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[d.Bz.forChild($),d.Bz]}),o})();var W=c(7468),X=c(3148),tt=c(9499),nt=c(4466);let ot=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[u.ez,k,W.q,X.IJ,tt.O,nt.m]}),o})()}}]);