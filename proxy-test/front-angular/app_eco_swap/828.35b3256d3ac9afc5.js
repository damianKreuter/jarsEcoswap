"use strict";(self.webpackChunkapp_eco_swap=self.webpackChunkapp_eco_swap||[]).push([[828],{9499:(P,u,r)=>{r.d(u,{O:()=>C});var p=r(4755),g=r(9433),a=r(9401),f=r(3148),l=r(2223);let C=(()=>{class o{}return o.\u0275fac=function(i){return new(i||o)},o.\u0275mod=l.oAB({type:o}),o.\u0275inj=l.cJS({imports:[p.ez,g.q,f.IJ,a.u5,a.UX]}),o})()},2828:(P,u,r)=>{r.r(u),r.d(u,{FormColectaModule:()=>H});var p=r(4755),g=r(1531),a=r(9401),f=r(1217),l=r(5226),C=r.n(l),o=r(2223),h=r(8628),i=r(4377),O=r(4893),_=r(9114),F=r(430),A=r(9609),T=r(8467),Z=r(1728),x=r(787),v=r(8280),M=r(6012),E=r(7876),I=r(4984);function U(t,c){1&t&&(o.TgZ(0,"mat-error"),o._uU(1," Campo obligatorio "),o.qZA())}function y(t,c){1&t&&(o.TgZ(0,"mat-error"),o._uU(1," Las fechas de inicio y fin son obligatorias "),o.qZA())}function b(t,c){1&t&&(o.TgZ(0,"mat-error"),o._uU(1,"Fecha de inicio inv\xe1lida"),o.qZA())}function N(t,c){1&t&&(o.TgZ(0,"mat-error"),o._uU(1,"Fecha de fin inv\xe1lida"),o.qZA())}function S(t,c){1&t&&(o.TgZ(0,"mat-error"),o._uU(1," Campo obligatorio "),o.qZA())}function J(t,c){1&t&&(o.TgZ(0,"mat-error",37),o._uU(1," El valor debe ser mayor a 0. "),o.qZA())}function D(t,c){if(1&t&&(o.TgZ(0,"mat-option",38),o._uU(1),o.qZA()),2&t){const e=c.$implicit;o.Q6J("value",e.nombre),o.xp6(1),o.hij(" ",e.descripcion," ")}}function L(t,c){1&t&&(o.TgZ(0,"mat-error"),o._uU(1," Campo obligatorio "),o.qZA())}function R(t,c){if(1&t){const e=o.EpF();o.TgZ(0,"div",28)(1,"mat-form-field"),o._UZ(2,"input",29),o.YNc(3,S,2,0,"mat-error",6),o.qZA(),o.TgZ(4,"mat-form-field")(5,"mat-label"),o._uU(6,"Cantidad solicitada"),o.qZA(),o._UZ(7,"input",30),o.YNc(8,J,2,0,"mat-error",31),o.qZA(),o.TgZ(9,"mat-form-field")(10,"mat-label"),o._uU(11,"Tipo"),o.qZA(),o.TgZ(12,"mat-select",32),o.YNc(13,D,2,2,"mat-option",33),o.qZA(),o.YNc(14,L,2,0,"mat-error",6),o.qZA(),o.TgZ(15,"mat-form-field",34),o._UZ(16,"input",35),o.qZA(),o.TgZ(17,"button",36),o.NdJ("click",function(){const s=o.CHM(e).index,d=o.oxw();return o.KtG(d.removeProducto(s))}),o.TgZ(18,"mat-icon"),o._uU(19,"delete"),o.qZA()()()}if(2&t){const e=c.$implicit,n=c.index,m=o.oxw();o.Q6J("formGroupName",n)("ngClass",e.hasError("min")?"show-product-error":""),o.xp6(3),o.Q6J("ngIf",e.get("s_descripcion").hasError("required")),o.xp6(5),o.Q6J("ngIf",e.get("n_cantidad_solicitada").hasError("min")),o.xp6(5),o.Q6J("ngForOf",m.tipos_productos),o.xp6(1),o.Q6J("ngIf",e.get("tipo_producto").hasError("required")),o.xp6(1),o.Q6J("hidden",!0),o.xp6(1),o.Q6J("hidden",!0)}}function q(t,c){1&t&&(o.TgZ(0,"mat-error"),o._uU(1," La colecta debe tener al menos 1 producto "),o.qZA())}function Q(t,c){1&t&&(o.TgZ(0,"mat-error"),o._uU(1," La colecta debe tener al menos 1 imagen "),o.qZA())}function Y(t,c){if(1&t){const e=o.EpF();o.TgZ(0,"div",39),o.NdJ("click",function(){const s=o.CHM(e).$implicit,d=o.oxw();return o.KtG(d.removeImagen(s))}),o.TgZ(1,"div",40),o._UZ(2,"div",41),o.TgZ(3,"mat-icon",42),o._uU(4,"delete"),o.qZA(),o._UZ(5,"img",43),o.qZA()()}if(2&t){const e=c.$implicit;o.xp6(5),o.Q6J("src",e,o.LSH)}}function B(t,c){1&t&&o._UZ(0,"mat-spinner",44)}const k=["BUEN_ESTADO","ROTO_PERO_UTIL","ROTO"],w=[{path:"",component:(()=>{class t{constructor(e,n,m,s,d,$,V){this.fb=e,this.route=n,this.donacionesService=m,this.auth=s,this.router=d,this.dateAdapter=$,this.productosService=V,this.fileName="Subir Imagen",this.images=[],this.tipos_productos=[],this.loadingImg=!1,this.showErrors=!1,this.loadingSave=!1,this.dateAdapter.setLocale("es"),this.estados_productos=k,this.colectaForm=e.group({s_titulo:["",a.kI.required],s_descripcion:["",a.kI.required],productos:this.fb.array([]),file_name:[this.fileName],file:["",a.kI.required],file_source:[""],fecha_inicio:["",a.kI.required],fecha_fin:["",a.kI.required]}),this.screenWidth=window.innerWidth>0?window.innerWidth:screen.width,this.getTiposProductos()}getTiposProductos(){this.productosService.getTiposProductos().subscribe({next:e=>{this.tipos_productos=e},error:e=>{console.error("error",e)},complete:()=>console.info("complete")})}get getProductosArray(){return this.colectaForm.get("productos")}agregarProducto(){const e=this.fb.group({s_descripcion:["",a.kI.required],n_cantidad_solicitada:[""],tipo_producto:["",a.kI.required],estado:["-"]});this.getProductosArray.push(e)}crearColecta(){if(console.log(this.colectaForm.value),this.showErrors=!0,this.colectaForm.valid){this.loadingSave=!0;const e=[];for(const n of this.getProductosArray.value)e.push({tipoProducto:n.tipo_producto,cantidadRequerida:n.n_cantidad_solicitada,descripcion:n.s_descripcion,estado:n.estado});console.log("prdos",e),this.donacionesService.crearColecta({titulo:this.colectaForm.controls.s_titulo.value,descripcion:this.colectaForm.controls.s_descripcion.value,productos:e,imagen:this.colectaForm.controls.file_source.value[0],fechaInicio:this.colectaForm.controls.fecha_inicio.value,fechaFin:this.colectaForm.controls.fecha_fin.value}).subscribe({next:n=>{JSON.parse(JSON.stringify(n)).descripcion?(this.showMessage("\xa1Colecta Creada!","La colecta se cre\xf3 exitosamente. Los particulares te contactar\xe1n pronto!","success"),this.router.navigateByUrl("mis-colectas")):this.showMessage("Ocurri\xf3 un error","No pudimos crear la colecta. Intent\xe1 nuevamente luego.","error"),this.loadingSave=!1},error:n=>{console.log("error al crear colecta",n),this.loadingSave=!1}})}else this.showMessage("Error en los campos","Hay un error en los campos ingresados, por favor revisalos y volv\xe9 a intentar.","error")}removeProducto(e){this.getProductosArray.removeAt(e)}onFileChange(e){if(e.target.files&&e.target.files[0]){var n=e.target.files.length;for(let s=0;s<n;s++){var m=new FileReader;m.onload=d=>{this.images.push(d.target.result),this.colectaForm.patchValue({file_source:this.images})},m.readAsDataURL(e.target.files[s])}this.loadingImg=!1}}removeImagen(e){let n=this.colectaForm.controls.file_source.value.findIndex(m=>m==e);this.colectaForm.controls.file_source.value.splice(n,1),this.colectaForm.controls.file.setValue("")}showMessage(e,n,m){C().fire({title:e,text:n,icon:m,confirmButtonText:"\xa1OK!"})}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(a.qu),o.Y36(g.gz),o.Y36(h.M),o.Y36(i.e),o.Y36(g.F0),o.Y36(f._A),o.Y36(O.k))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-form-colecta"]],features:[o._Bn([{provide:f.Ad,useValue:"en-GB"}])],decls:60,vars:15,consts:[["id","main-form-colecta",1,"app-main-div"],["id","main-card"],[2,"margin-bottom","20px"],[1,"form",3,"formGroup","ngClass"],[1,"form-col","main-data"],["matInput","","formControlName","s_titulo"],[4,"ngIf"],["matInput","","formControlName","s_descripcion"],[1,"datepicker-form-field"],[3,"rangePicker"],["matStartDate","","formControlName","fecha_inicio","placeholder","Inicio"],["matEndDate","","formControlName","fecha_fin","placeholder","Fin"],["matIconSuffix","",3,"for"],["picker",""],["formArrayName","productos",1,"form-col"],[1,"big-label"],["class","producto",3,"formGroupName","ngClass",4,"ngFor","ngForOf"],["type","button","mat-fab","","extended","","color","light",3,"click"],[1,"form-col","imagen"],["for","file",1,"big-label"],["formControlName","file","id","file","type","file","accept",".jpg, .jpeg, .png, .webp",1,"form-control","hidden",3,"change"],["file",""],[3,"loading"],[1,"form-col","form-imgs"],["class","show-image",3,"click",4,"ngFor","ngForOf"],[1,"buttons"],["mat-fab","","extended","","color","accent",3,"disabled","click"],["diameter","20","style","margin-left: 10px;",4,"ngIf"],[1,"producto",3,"formGroupName","ngClass"],["matInput","","placeholder","Descripci\xf3n*","formControlName","s_descripcion"],["matInput","","formControlName","n_cantidad_solicitada","type","number","min","0"],["class","error",4,"ngIf"],["formControlName","tipo_producto"],[3,"value",4,"ngFor","ngForOf"],[3,"hidden"],["matInput","","formControlName","estado","type","text",3,"hidden"],["type","button","mat-icon-button","","color","light",3,"click"],[1,"error"],[3,"value"],[1,"show-image",3,"click"],[1,"image"],[1,"overlay"],["color","primary",1,"update"],[1,"img-producto",3,"src"],["diameter","20",2,"margin-left","10px"]],template:function(e,n){if(1&e){const m=o.EpF();o._UZ(0,"app-header"),o.TgZ(1,"div",0)(2,"mat-card",1)(3,"mat-card-header",2)(4,"mat-card-title"),o._uU(5,"Complet\xe1 los datos de tu colecta!"),o.qZA()(),o.TgZ(6,"mat-card-content")(7,"form",3)(8,"div",4)(9,"mat-form-field")(10,"mat-label"),o._uU(11,"T\xedtulo"),o.qZA(),o._UZ(12,"input",5),o.YNc(13,U,2,0,"mat-error",6),o.qZA(),o.TgZ(14,"mat-form-field")(15,"mat-label"),o._uU(16,"Descripci\xf3n"),o.qZA(),o._UZ(17,"input",7),o.qZA(),o.TgZ(18,"mat-form-field",8)(19,"mat-label"),o._uU(20,"Vigencia"),o.qZA(),o.TgZ(21,"mat-date-range-input",9),o._UZ(22,"input",10)(23,"input",11),o.qZA(),o._UZ(24,"mat-datepicker-toggle",12)(25,"mat-date-range-picker",null,13),o.YNc(27,y,2,0,"mat-error",6),o.YNc(28,b,2,0,"mat-error",6),o.YNc(29,N,2,0,"mat-error",6),o.qZA()(),o.TgZ(30,"section",14)(31,"div")(32,"label",15),o._uU(33,"Productos"),o.qZA()(),o.TgZ(34,"div"),o.YNc(35,R,20,8,"div",16),o.TgZ(36,"button",17),o.NdJ("click",function(){return n.agregarProducto()}),o.TgZ(37,"mat-icon"),o._uU(38,"add"),o.qZA(),o.TgZ(39,"label"),o._uU(40,"Agregar Producto"),o.qZA()(),o.YNc(41,q,2,0,"mat-error",6),o.qZA()(),o._UZ(42,"div"),o.TgZ(43,"div",18)(44,"label",19),o._uU(45,"Imagen de la Colecta"),o.qZA(),o.TgZ(46,"button",17),o.NdJ("click",function(){o.CHM(m);const d=o.MAs(51);return o.KtG(d.click())}),o.TgZ(47,"mat-icon"),o._uU(48,"add"),o.qZA(),o._uU(49," Agregar Imagen "),o.qZA(),o.TgZ(50,"input",20,21),o.NdJ("change",function(d){return n.onFileChange(d)}),o.qZA(),o.YNc(52,Q,2,0,"mat-error",6),o._UZ(53,"app-spinner",22),o.qZA(),o.TgZ(54,"div",23),o.YNc(55,Y,6,1,"div",24),o.qZA()()(),o.TgZ(56,"mat-card-actions",25)(57,"button",26),o.NdJ("click",function(){return n.crearColecta(),n.colectaForm.markAllAsTouched(),n.colectaForm.valid}),o._uU(58," CREAR COLECTA "),o.qZA(),o.YNc(59,B,1,0,"mat-spinner",27),o.qZA()()()}if(2&e){const m=o.MAs(26);o.xp6(7),o.Q6J("formGroup",n.colectaForm)("ngClass",n.screenWidth>576?"big-form":"small-form"),o.xp6(6),o.Q6J("ngIf",n.colectaForm.get("s_titulo").hasError("required")),o.xp6(8),o.Q6J("rangePicker",m),o.xp6(3),o.Q6J("for",m),o.xp6(3),o.Q6J("ngIf",n.colectaForm.get("fecha_inicio").hasError("required")||n.colectaForm.get("fecha_fin").hasError("required")),o.xp6(1),o.Q6J("ngIf",n.colectaForm.controls.fecha_inicio.hasError("matStartDateInvalid")),o.xp6(1),o.Q6J("ngIf",n.colectaForm.controls.fecha_fin.hasError("matEndDateInvalid")),o.xp6(6),o.Q6J("ngForOf",n.getProductosArray.controls),o.xp6(6),o.Q6J("ngIf",0==n.getProductosArray.length&&n.showErrors),o.xp6(11),o.Q6J("ngIf",n.colectaForm.get("file").hasError("required")&&n.showErrors),o.xp6(1),o.Q6J("loading",n.loadingImg),o.xp6(2),o.Q6J("ngForOf",n.images),o.xp6(2),o.Q6J("disabled",n.loadingSave),o.xp6(2),o.Q6J("ngIf",n.loadingSave)}},dependencies:[p.mk,p.sg,p.O5,_.KE,_.hX,_.TO,_.R9,F.Hw,A.Nt,T.Ou,Z.RK,Z.cs,x.gD,f.ey,v.nW,v.wx,v.zY,v.By,v._g,M.a8,M.hq,M.dn,M.dk,M.n5,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.qQ,a.sg,a.u,a.x0,a.CE,E.G,I.O],styles:["#main-form-colecta[_ngcontent-%COMP%]{padding:2%}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]{padding:5px}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-input[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]   .show-image[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;cursor:pointer}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]   .show-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative;width:-moz-fit-content;width:fit-content;display:flex;align-items:center;justify-content:center}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]   .show-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:hover > .overlay[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;background-color:#000;opacity:.5;transition:all 1s}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]   .show-image[_ngcontent-%COMP%]:hover   mat-icon[_ngcontent-%COMP%]{display:block}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]   .show-image[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:absolute;display:none}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.imagen[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]   .big-label[_ngcontent-%COMP%]{font-weight:500;font-size:medium;margin:20px 5px 10px}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]   .hidden[_ngcontent-%COMP%]{display:none}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]   .producto[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr .2fr;border-bottom:1px solid var(--light-grey);margin-bottom:15px}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]   .producto[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{padding:5px}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]   .producto[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:60px;margin-left:5px}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .main-data[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 4fr 3fr}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .main-data[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{padding:5px}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .img-producto[_ngcontent-%COMP%]{width:100px;margin:3px}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .img-producto[_ngcontent-%COMP%]:hover{cursor:pointer}#main-form-colecta[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;margin:20px}@media (min-width: 577px) and (max-width: 768px){.main-data[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr!important}.error[_ngcontent-%COMP%]{font-size:10px}.show-product-error[_ngcontent-%COMP%]{padding-bottom:20px}}@media (min-width: 0px) and (max-width: 576px){.producto[_ngcontent-%COMP%]{grid-template-columns:1fr!important}.producto[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:auto!important}.main-data[_ngcontent-%COMP%]{grid-template-columns:1fr!important}}"]}),t})()}];let K=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[g.Bz.forChild(w),g.Bz]}),t})();var W=r(9433),G=r(3148),z=r(9499),j=r(4466);let H=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[p.ez,K,W.q,G.IJ,z.O,j.m]}),t})()},8628:(P,u,r)=>{r.d(u,{M:()=>C});var p=r(2340),g=r(2223),a=r(5500);const f=p.N.apiUrl+"8080/",l="URImsUsuarios";let C=(()=>{class o{constructor(i){this.backendService=i}crearColecta(i){return this.backendService.post(l,"api/colecta",i)}getAllColectas(i){return this.backendService.get(l,"api/colectas",i)}getMisColectas(){return this.backendService.get(l,"api/misColectas")}getColecta(i){return this.backendService.get(l,"api/colecta/"+i)}getDonacionesColecta(i){return this.backendService.get(l,"api/colecta/"+i+"/donaciones")}getMisDonaciones(){return this.backendService.get(l,"api/particular/misDonaciones")}crearDonacion(i,O){return this.backendService.post(l,"api/colecta/"+i+"/crearDonacion",O)}getImagen(i){return`${f}api/getImage/${i}`}cambiarEstadoDonacion(i,O,_){return this.backendService.put(l,"api/colecta/"+i+"/donaciones/"+O,_)}}return o.\u0275fac=function(i){return new(i||o)(g.LFG(a.k))},o.\u0275prov=g.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()}}]);