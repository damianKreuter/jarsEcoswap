"use strict";(self.webpackChunkapp_eco_swap=self.webpackChunkapp_eco_swap||[]).push([[841],{8841:(K,m,n)=>{n.r(m),n.d(m,{PublicacionesModule:()=>L});var l=n(4755),u=n(1531),f=n(5226),g=n.n(f),o=n(2223),h=n(4377),r=n(9401),v=n(4893),b=n(3073),P=n(2777),C=n(1562);let x=(()=>{class t{constructor(i){this.backendService=i}getMyCompras(){return this.backendService.get("URImsUsuarios","api/misCompras")}}return t.\u0275fac=function(i){return new(i||t)(o.LFG(C.k))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var p=n(9114),M=n(430),S=n(9609),d=n(1728),Z=n(787),y=n(1217),F=n(3649),A=n(7876),I=n(4984),J=n(8719);function O(t,s){if(1&t&&(o.TgZ(0,"mat-option",16),o._uU(1),o.qZA()),2&t){const i=s.$implicit;o.Q6J("value",i.nombre),o.xp6(1),o.hij(" ",i.descripcion," ")}}function w(t,s){if(1&t){const i=o.EpF();o.TgZ(0,"form",8)(1,"mat-form-field",9)(2,"mat-label"),o._uU(3,"C\xf3digo Postal"),o.qZA(),o._UZ(4,"input",10),o.qZA(),o.TgZ(5,"mat-form-field",9)(6,"mat-label"),o._uU(7,"Tipo del Producto"),o.qZA(),o.TgZ(8,"mat-select",11),o.YNc(9,O,2,2,"mat-option",12),o.qZA()(),o.TgZ(10,"div",13)(11,"button",14),o.NdJ("click",function(){o.CHM(i);const c=o.oxw();return o.KtG(c.filtrarPublicaciones())}),o._uU(12,"FILTRAR"),o.qZA(),o.TgZ(13,"button",15),o.NdJ("click",function(){o.CHM(i);const c=o.oxw();return o.KtG(c.limpiarFiltros())}),o._uU(14,"LIMPIAR"),o.qZA()()()}if(2&t){const i=o.oxw();o.Q6J("formGroup",i.formFiltros),o.xp6(9),o.Q6J("ngForOf",i.tipos_productos)}}function U(t,s){1&t&&(o.TgZ(0,"div",13),o._uU(1,"No hay publicaciones para mostrar"),o.qZA())}function N(t,s){if(1&t&&(o.TgZ(0,"div",2),o.YNc(1,U,2,0,"div",17),o.TgZ(2,"div"),o._UZ(3,"app-deck-publicaciones",18),o.qZA()()),2&t){const i=o.oxw();o.xp6(1),o.Q6J("ngIf",0==i.publicacionesToShow.length),o.xp6(2),o.Q6J("publicacionesToShow",i.publicacionesToShow)}}const Y=[{path:"",component:(()=>{class t{constructor(i,e,c,a,j,z,H){this.router=i,this.auth=e,this.fb=c,this.productosService=a,this.showErrorService=j,this.truequesService=z,this.comprasService=H,this.origin="all",this.tipos_productos=[],this.loading=!1,this.publicacionesToShow=[],this.formFiltros=c.group({fundacion:[""],codigoPostal:[""],tipoProducto:[""]}),"/mis-publicaciones"==i.url&&(this.origin="myPublicaciones"),"/mis-compras"==i.url&&(this.origin="myCompras"),this.getTiposProductos(),this.filtrarPublicaciones()}addPublicacion(){this.auth.isUserLoggedIn?this.router.navigate(["form-publicacion"]):g().fire({title:"\xa1Necesit\xe1s una cuenta!",text:"Para poder crear una publicaci\xf3n, ten\xe9s que usar tu cuenta.",icon:"warning",confirmButtonText:"Iniciar sesi\xf3n",showCancelButton:!0,cancelButtonText:"Cancelar"}).then(({isConfirmed:i})=>{i&&this.router.navigate(["login"])})}getTiposProductos(){this.productosService.getTiposProductos().subscribe({next:i=>{this.tipos_productos=i},error:i=>{console.error("error",i),this.showErrorService.show("Error!","Ha ocurrido un error al traer los tipos de producto")}})}filtrarPublicaciones(){if("all"==this.origin){this.filtros={};const i=this.formFiltros.controls.codigoPostal.value,e=this.formFiltros.controls.tipoProducto.value;i&&(this.filtros.codigoPostal=i),e&&(this.filtros.tipoProducto=e),this.truequesService.getPublicaciones(this.filtros).subscribe({next:c=>{console.log(c),this.publicacionesToShow=c,this.publicacionesToShow.map(a=>{a.parsedImagenes=a.imagenes.split("|")})}})}else"myPublicaciones"==this.origin?this.truequesService.getMisPublicaciones().subscribe({next:i=>{console.log(i),this.publicacionesToShow=i,this.publicacionesToShow.map(e=>{e.parsedImagenes=e.imagenes.split("|")})}}):this.comprasService.getMyCompras().subscribe({next:i=>{console.log(i),this.publicacionesToShow=i,this.publicacionesToShow.map(e=>{e.parsedImagenes=e.imagenes.split("|")})}})}limpiarFiltros(){this.formFiltros.reset(),this.filtrarPublicaciones()}}return t.\u0275fac=function(i){return new(i||t)(o.Y36(u.F0),o.Y36(h.e),o.Y36(r.qu),o.Y36(v.k),o.Y36(b.x),o.Y36(P.x),o.Y36(x))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-trueque"]],decls:10,vars:4,consts:[[3,"title"],["id","main-publicaciones"],[1,"row"],["id","form-filtros",3,"formGroup",4,"ngIf"],[3,"loading"],["class","row",4,"ngIf"],[1,"floating-button-container"],["mat-fab","","color","primary","aria-label","Agregar Publicaci\xf3n","matTooltip","Agregar Publicaci\xf3n","matTooltipPosition","before",3,"click"],["id","form-filtros",3,"formGroup"],["appearance","outline"],["matInput","","formControlName","codigoPostal","type","number"],["formControlName","tipoProducto","panelClass","example-panel"],[3,"value",4,"ngFor","ngForOf"],[2,"text-align","center"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","",3,"click"],[3,"value"],["style","text-align: center;",4,"ngIf"],[3,"publicacionesToShow"]],template:function(i,e){1&i&&(o._UZ(0,"app-header",0),o.TgZ(1,"div",1)(2,"div",2),o.YNc(3,w,15,2,"form",3),o.qZA(),o._UZ(4,"app-spinner",4),o.YNc(5,N,4,2,"div",5),o.TgZ(6,"div",6)(7,"button",7),o.NdJ("click",function(){return e.addPublicacion()}),o.TgZ(8,"mat-icon"),o._uU(9,"add"),o.qZA()()()()),2&i&&(o.Q6J("title","all"==e.origin?"Publicaciones":"myPublicaciones"==e.origin?"Mis Publicaciones":"Mis Compras"),o.xp6(3),o.Q6J("ngIf","all"==e.origin),o.xp6(1),o.Q6J("loading",e.loading),o.xp6(1),o.Q6J("ngIf",!e.loading))},dependencies:[l.sg,l.O5,p.KE,p.hX,M.Hw,S.Nt,d.lW,d.cs,Z.gD,y.ey,F.gM,r._Y,r.Fj,r.wV,r.JJ,r.JL,r.sg,r.u,A.G,I.O,J.G],styles:["#main-publicaciones[_ngcontent-%COMP%]{padding:2%}#main-publicaciones[_ngcontent-%COMP%]   #form-filtros[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;justify-items:center;align-items:baseline}#main-publicaciones[_ngcontent-%COMP%]   #form-filtros[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{max-width:100%;padding:5px}#main-publicaciones[_ngcontent-%COMP%]   #form-filtros[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:2px;max-width:40%}#main-publicaciones[_ngcontent-%COMP%]   .floating-button-container[_ngcontent-%COMP%]{position:fixed;right:25px;bottom:40px}@media (min-width: 577px) and (max-width: 768px){#form-filtros[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr!important}}@media (min-width: 0px) and (max-width: 576px){#form-filtros[_ngcontent-%COMP%]{grid-template-columns:1fr!important}}"]}),t})()}];let Q=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[u.Bz.forChild(Y),u.Bz]}),t})();var B=n(5110),G=n(3148),R=n(9499),E=n(4466);let L=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[l.ez,Q,B.q,G.IJ,R.O,E.m]}),t})()}}]);