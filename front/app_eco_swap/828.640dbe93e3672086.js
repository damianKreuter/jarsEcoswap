"use strict";(self.webpackChunkapp_eco_swap=self.webpackChunkapp_eco_swap||[]).push([[828],{2828:(H,C,r)=>{r.r(C),r.d(C,{FormColectaModule:()=>j});var g=r(4755),f=r(1531),i=r(9401),p=r(1217),h=r(5226),O=r.n(h),o=r(2223),M=r(8628),P=r(4377),u=r(9114),v=r(430),Z=r(9609),_=r(1728),F=r(787),s=r(8280),d=r(6012),A=r(7876),T=r(4984);function x(t,a){1&t&&(o.TgZ(0,"mat-error"),o._uU(1," Campo obligatorio "),o.qZA())}function y(t,a){1&t&&(o.TgZ(0,"mat-error"),o._uU(1," Las fechas de inicio y fin son obligatorias "),o.qZA())}function I(t,a){1&t&&(o.TgZ(0,"mat-error"),o._uU(1,"Fecha de inicio inv\xe1lida"),o.qZA())}function U(t,a){1&t&&(o.TgZ(0,"mat-error"),o._uU(1,"Fecha de fin inv\xe1lida"),o.qZA())}function N(t,a){1&t&&(o.TgZ(0,"mat-error"),o._uU(1," Campo obligatorio "),o.qZA())}function E(t,a){if(1&t&&(o.TgZ(0,"mat-option",33),o._uU(1),o.qZA()),2&t){const n=a.$implicit;o.Q6J("value",n),o.xp6(1),o.hij(" ",n," ")}}function J(t,a){1&t&&(o.TgZ(0,"mat-error"),o._uU(1," Campo obligatorio "),o.qZA())}function q(t,a){if(1&t){const n=o.EpF();o.TgZ(0,"div",25)(1,"mat-form-field"),o._UZ(2,"input",26),o.YNc(3,N,2,0,"mat-error",6),o.qZA(),o.TgZ(4,"mat-form-field")(5,"mat-label"),o._uU(6,"Cantidad solicitada"),o.qZA(),o._UZ(7,"input",27),o.qZA(),o.TgZ(8,"mat-form-field")(9,"mat-label"),o._uU(10,"Tipo"),o.qZA(),o.TgZ(11,"mat-select",28),o.YNc(12,E,2,2,"mat-option",29),o.qZA(),o.YNc(13,J,2,0,"mat-error",6),o.qZA(),o.TgZ(14,"mat-form-field",30),o._UZ(15,"input",31),o.qZA(),o.TgZ(16,"button",32),o.NdJ("click",function(){const m=o.CHM(n).index,l=o.oxw();return o.KtG(l.removeProducto(m))}),o.TgZ(17,"mat-icon"),o._uU(18,"delete"),o.qZA()()()}if(2&t){const n=a.$implicit,e=a.index,c=o.oxw();o.Q6J("formGroupName",e),o.xp6(3),o.Q6J("ngIf",n.get("s_descripcion").hasError("required")),o.xp6(9),o.Q6J("ngForOf",c.tipos_productos),o.xp6(1),o.Q6J("ngIf",n.get("tipo_producto").hasError("required")),o.xp6(1),o.Q6J("hidden",!0),o.xp6(1),o.Q6J("hidden",!0)}}function b(t,a){1&t&&(o.TgZ(0,"mat-error"),o._uU(1," La colecta debe tener al menos 1 producto "),o.qZA())}function w(t,a){1&t&&(o.TgZ(0,"mat-error"),o._uU(1," La colecta debe tener al menos 1 imagen "),o.qZA())}function S(t,a){if(1&t){const n=o.EpF();o.TgZ(0,"div",34),o.NdJ("click",function(){const m=o.CHM(n).$implicit,l=o.oxw();return o.KtG(l.removeImagen(m))}),o.TgZ(1,"div",35),o._UZ(2,"div",36),o.TgZ(3,"mat-icon",37),o._uU(4,"delete"),o.qZA(),o._UZ(5,"img",38),o.qZA()()}if(2&t){const n=a.$implicit;o.xp6(5),o.Q6J("src",n,o.LSH)}}const Q=["COLCHONES_Y_FRAZADAS","LIBROS","MUEBLES","OTROS","SALUD","TECNOLOGIA"],Y=["BUEN_ESTADO","ROTO_PERO_UTIL","ROTO"],L=[{path:"",component:(()=>{class t{constructor(n,e,c,m,l,z){this.fb=n,this.route=e,this.donacionesService=c,this.auth=m,this.router=l,this.dateAdapter=z,this.fileName="Subir Imagen",this.images=[],this.loadingImg=!1,this.showErrors=!1,this.dateAdapter.setLocale("es"),this.tipos_productos=Q,this.estados_productos=Y,this.colectaForm=n.group({s_titulo:["",i.kI.required],s_descripcion:["",i.kI.required],productos:this.fb.array([]),file_name:[this.fileName],file:["",i.kI.required],file_source:[""],fecha_inicio:["",i.kI.required],fecha_fin:["",i.kI.required]}),this.screenWidth=window.innerWidth>0?window.innerWidth:screen.width}get getProductosArray(){return this.colectaForm.get("productos")}agregarProducto(){const n=this.fb.group({s_descripcion:["",i.kI.required],n_cantidad_solicitada:[""],tipo_producto:["",i.kI.required],estado:["-"]});this.getProductosArray.push(n)}crearColecta(){if(console.log(this.colectaForm.value),this.showErrors=!0,this.colectaForm.valid){const n=[];for(const e of this.getProductosArray.value)n.push({tipoProducto:e.tipo_producto,cantidadRequerida:e.n_cantidad_solicitada,descripcion:e.s_descripcion,estado:e.estado});console.log("prdos",n),this.donacionesService.crearColecta({titulo:this.colectaForm.controls.s_titulo.value,descripcion:this.colectaForm.controls.s_descripcion.value,productos:n,imagen:this.colectaForm.controls.file_source.value[0],fechaInicio:this.colectaForm.controls.fecha_inicio.value,fechaFin:this.colectaForm.controls.fecha_fin.value}).subscribe({next:e=>{JSON.parse(JSON.stringify(e)).descripcion?(this.showMessage("\xa1Colecta Creada!","La colecta se cre\xf3 exitosamente. Los particulares te contactar\xe1n pronto!","success"),this.router.navigateByUrl("mis-colectas")):this.showMessage("Ocurri\xf3 un error","No pudimos crear la colecta. Intent\xe1 nuevamente luego.","error")},error:e=>{console.log("error al crear colecta",e),this.showMessage("Ocurri\xf3 un error","No pudimos crear la colecta. Intent\xe1 nuevamente luego.","error")}})}else this.showMessage("Error en los campos","Hay un error en los campos ingresados, por favor revisalos y volv\xe9 a intentar.","error")}removeProducto(n){this.getProductosArray.removeAt(n)}onFileChange(n){if(n.target.files&&n.target.files[0]){var e=n.target.files.length;for(let m=0;m<e;m++){var c=new FileReader;c.onload=l=>{this.images.push(l.target.result),this.colectaForm.patchValue({file_source:this.images})},c.readAsDataURL(n.target.files[m])}this.loadingImg=!1}}removeImagen(n){let e=this.colectaForm.controls.file_source.value.findIndex(c=>c==n);this.colectaForm.controls.file_source.value.splice(e,1),this.colectaForm.controls.file.setValue("")}showMessage(n,e,c){O().fire({title:n,text:e,icon:c,confirmButtonText:"\xa1OK!"})}}return t.\u0275fac=function(n){return new(n||t)(o.Y36(i.qu),o.Y36(f.gz),o.Y36(M.M),o.Y36(P.e),o.Y36(f.F0),o.Y36(p._A))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-form-colecta"]],features:[o._Bn([{provide:p.Ad,useValue:"en-GB"}])],decls:54,vars:13,consts:[["id","main-form-colecta"],["id","main-card"],[2,"margin-bottom","20px"],[1,"form",3,"formGroup","ngClass"],[1,"form-col","main-data"],["matInput","","formControlName","s_titulo"],[4,"ngIf"],["matInput","","formControlName","s_descripcion"],[1,"datepicker-form-field"],[3,"rangePicker"],["matStartDate","","formControlName","fecha_inicio","placeholder","Inicio"],["matEndDate","","formControlName","fecha_fin","placeholder","Fin"],["matIconSuffix","",3,"for"],["picker",""],["formArrayName","productos",1,"form-col"],["class","producto",3,"formGroupName",4,"ngFor","ngForOf"],["type","button","mat-raised-button","",3,"click"],[1,"form-col"],["for","file"],["formControlName","file","id","file","type","file",1,"form-control",3,"change"],[3,"loading"],[1,"form-col","form-imgs"],["class","show-image",3,"click",4,"ngFor","ngForOf"],[1,"buttons"],["mat-raised-button","","color","primary",3,"click"],[1,"producto",3,"formGroupName"],["matInput","","placeholder","Descripci\xf3n*","formControlName","s_descripcion"],["matInput","","formControlName","n_cantidad_solicitada","type","number"],["formControlName","tipo_producto"],[3,"value",4,"ngFor","ngForOf"],[3,"hidden"],["matInput","","formControlName","estado","type","text",3,"hidden"],["type","button","mat-icon-button","","color","light",3,"click"],[3,"value"],[1,"show-image",3,"click"],[1,"image"],[1,"overlay"],["color","primary",1,"update"],[1,"img-producto",3,"src"]],template:function(n,e){if(1&n&&(o._UZ(0,"app-header"),o.TgZ(1,"div",0)(2,"mat-card",1)(3,"mat-card-header",2)(4,"mat-card-title"),o._uU(5,"Complet\xe1 los datos de tu colecta!"),o.qZA()(),o.TgZ(6,"mat-card-content")(7,"form",3)(8,"div",4)(9,"mat-form-field")(10,"mat-label"),o._uU(11,"T\xedtulo"),o.qZA(),o._UZ(12,"input",5),o.YNc(13,x,2,0,"mat-error",6),o.qZA(),o.TgZ(14,"mat-form-field")(15,"mat-label"),o._uU(16,"Descripci\xf3n"),o.qZA(),o._UZ(17,"input",7),o.qZA(),o.TgZ(18,"mat-form-field",8)(19,"mat-label"),o._uU(20,"Vigencia"),o.qZA(),o.TgZ(21,"mat-date-range-input",9),o._UZ(22,"input",10)(23,"input",11),o.qZA(),o._UZ(24,"mat-datepicker-toggle",12)(25,"mat-date-range-picker",null,13),o.YNc(27,y,2,0,"mat-error",6),o.YNc(28,I,2,0,"mat-error",6),o.YNc(29,U,2,0,"mat-error",6),o.qZA()(),o.TgZ(30,"section",14)(31,"div")(32,"label"),o._uU(33,"Productos"),o.qZA()(),o.TgZ(34,"div"),o.YNc(35,q,19,6,"div",15),o.TgZ(36,"button",16),o.NdJ("click",function(){return e.agregarProducto()}),o.TgZ(37,"mat-icon"),o._uU(38,"add"),o.qZA(),o.TgZ(39,"label"),o._uU(40,"Agregar Producto"),o.qZA()(),o.YNc(41,b,2,0,"mat-error",6),o.qZA()(),o._UZ(42,"div"),o.TgZ(43,"div",17)(44,"label",18),o._uU(45,"Imagen de la Colecta"),o.qZA(),o.TgZ(46,"input",19),o.NdJ("change",function(m){return e.onFileChange(m)}),o.qZA(),o.YNc(47,w,2,0,"mat-error",6),o._UZ(48,"app-spinner",20),o.qZA(),o.TgZ(49,"div",21),o.YNc(50,S,6,1,"div",22),o.qZA()()(),o.TgZ(51,"mat-card-actions",23)(52,"button",24),o.NdJ("click",function(){return e.crearColecta(),e.colectaForm.markAllAsTouched(),e.colectaForm.valid}),o._uU(53," CREAR COLECTA "),o.qZA()()()()),2&n){const c=o.MAs(26);o.xp6(7),o.Q6J("formGroup",e.colectaForm)("ngClass",e.screenWidth>576?"big-form":"small-form"),o.xp6(6),o.Q6J("ngIf",e.colectaForm.get("s_titulo").hasError("required")),o.xp6(8),o.Q6J("rangePicker",c),o.xp6(3),o.Q6J("for",c),o.xp6(3),o.Q6J("ngIf",e.colectaForm.get("fecha_inicio").hasError("required")||e.colectaForm.get("fecha_fin").hasError("required")),o.xp6(1),o.Q6J("ngIf",e.colectaForm.controls.fecha_inicio.hasError("matStartDateInvalid")),o.xp6(1),o.Q6J("ngIf",e.colectaForm.controls.fecha_fin.hasError("matEndDateInvalid")),o.xp6(6),o.Q6J("ngForOf",e.getProductosArray.controls),o.xp6(6),o.Q6J("ngIf",0==e.getProductosArray.length&&e.showErrors),o.xp6(6),o.Q6J("ngIf",e.colectaForm.get("file").hasError("required")&&e.showErrors),o.xp6(1),o.Q6J("loading",e.loadingImg),o.xp6(2),o.Q6J("ngForOf",e.images)}},dependencies:[g.mk,g.sg,g.O5,u.KE,u.hX,u.TO,u.R9,v.Hw,Z.Nt,_.lW,_.RK,F.gD,p.ey,s.nW,s.wx,s.zY,s.By,s._g,d.a8,d.hq,d.dn,d.dk,d.n5,i._Y,i.Fj,i.wV,i.JJ,i.JL,i.sg,i.u,i.x0,i.CE,A.G,T.O],styles:["#main-form-colecta[_ngcontent-%COMP%]{padding:2%}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]{padding:5px}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-input[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]   .show-image[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;cursor:pointer}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]   .show-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{position:relative;width:-moz-fit-content;width:fit-content;display:flex;align-items:center;justify-content:center}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]   .show-image[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:hover > .overlay[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;background-color:#000;opacity:.5;transition:all 1s}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]   .show-image[_ngcontent-%COMP%]:hover   mat-icon[_ngcontent-%COMP%]{display:block}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col.form-imgs[_ngcontent-%COMP%]   .show-image[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:absolute;display:none}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]   .producto[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr .2fr;border-bottom:1px solid var(--light-grey);margin-bottom:15px}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]   .producto[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{padding:5px}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .form-col[_ngcontent-%COMP%]   .producto[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:60px;margin-left:5px}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .main-data[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr 1fr}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .main-data[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{padding:5px}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .img-producto[_ngcontent-%COMP%]{width:100px;margin:3px}#main-form-colecta[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]   .img-producto[_ngcontent-%COMP%]:hover{cursor:pointer}#main-form-colecta[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{display:flex;justify-content:center}@media (min-width: 577px) and (max-width: 768px){.main-data[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr!important}}@media (min-width: 0px) and (max-width: 576px){.producto[_ngcontent-%COMP%]{grid-template-columns:1fr!important}.producto[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:auto!important}.main-data[_ngcontent-%COMP%]{grid-template-columns:1fr!important}}"]}),t})()}];let R=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[f.Bz.forChild(L),f.Bz]}),t})();var k=r(5110),D=r(3148),B=r(9499),G=r(4466);let j=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[g.ez,R,k.q,D.IJ,B.O,G.m]}),t})()}}]);