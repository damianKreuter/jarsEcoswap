"use strict";(self.webpackChunkapp_eco_swap=self.webpackChunkapp_eco_swap||[]).push([[981],{1981:(q,p,e)=>{e.r(p),e.d(p,{ColectasModule:()=>X});var d=e(4755),m=e(1531),x=e(8675),M=e(4004),O=e(5226),P=e.n(O),o=e(2223),F=e(4377),Z=e(8628),T=e(1562);const f="URImsUsuarios";let y=(()=>{class n{constructor(t){this.backendService=t}getFundacion(t){return this.backendService.get(f,"fundacion/"+t)}getFundaciones(){return this.backendService.get(f,"fundaciones")}}return n.\u0275fac=function(t){return new(t||n)(o.LFG(T.k))},n.\u0275prov=o.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var a=e(9401),A=e(4893),w=e(3073),g=e(9114),_=e(430),J=e(9609),h=e(1728),U=e(787),S=e(1217),C=e(8995),I=e(3649),N=e(7876),b=e(4984);function Y(n,s){if(1&n&&(o.TgZ(0,"mat-option",19),o._uU(1),o.qZA()),2&n){const t=s.$implicit;o.Q6J("value",t),o.xp6(1),o.hij(" ",t.nombre," ")}}function Q(n,s){if(1&n&&(o.TgZ(0,"mat-option",19),o._uU(1),o.qZA()),2&n){const t=s.$implicit;o.Q6J("value",t.nombre),o.xp6(1),o.hij(" ",t.descripcion," ")}}function L(n,s){if(1&n){const t=o.EpF();o.TgZ(0,"form",7)(1,"mat-form-field",8)(2,"mat-label"),o._uU(3,"Fundaci\xf3n"),o.qZA(),o._UZ(4,"input",9),o.TgZ(5,"mat-autocomplete",10,11),o.YNc(7,Y,2,2,"mat-option",12),o.ALo(8,"async"),o.qZA()(),o.TgZ(9,"mat-form-field",13)(10,"mat-label"),o._uU(11,"C\xf3digo Postal"),o.qZA(),o._UZ(12,"input",14),o.qZA(),o.TgZ(13,"mat-form-field",13)(14,"mat-label"),o._uU(15,"Tipo del Producto"),o.qZA(),o.TgZ(16,"mat-select",15),o.YNc(17,Q,2,2,"mat-option",12),o.qZA()(),o.TgZ(18,"div",16)(19,"button",17),o.NdJ("click",function(){o.CHM(t);const c=o.oxw();return o.KtG(c.filtrarColectas())}),o._uU(20,"FILTRAR"),o.qZA(),o.TgZ(21,"button",18),o.NdJ("click",function(){o.CHM(t);const c=o.oxw();return o.KtG(c.limpiarFiltros())}),o._uU(22,"LIMPIAR"),o.qZA()()()}if(2&n){const t=o.MAs(6),i=o.oxw();o.Q6J("formGroup",i.formFiltros),o.xp6(4),o.Q6J("matAutocomplete",t),o.xp6(1),o.Q6J("displayWith",i.displayFn),o.xp6(2),o.Q6J("ngForOf",o.lcZ(8,5,i.filteredOptions)),o.xp6(10),o.Q6J("ngForOf",i.tipos_productos)}}function B(n,s){1&n&&(o.TgZ(0,"div",16),o._uU(1,"No hay colectas para mostrar"),o.qZA())}function E(n,s){if(1&n&&(o.TgZ(0,"div",32),o._uU(1),o.qZA()),2&n){const t=s.$implicit;o.xp6(1),o.hij(" ",t.descripcion," ")}}function G(n,s){if(1&n){const t=o.EpF();o.TgZ(0,"div",23),o.NdJ("click",function(){const r=o.CHM(t).$implicit,l=o.oxw(2);return o.KtG(l.goToColecta(r))}),o.TgZ(1,"div",24),o._UZ(2,"img",25),o.qZA(),o.TgZ(3,"div",26)(4,"h2",27),o._uU(5),o.qZA(),o.TgZ(6,"div",28),o.YNc(7,E,2,1,"div",29),o.qZA()(),o.TgZ(8,"div",30),o._UZ(9,"img",31),o.TgZ(10,"h4"),o._uU(11),o.qZA()()()}if(2&n){const t=s.$implicit;o.xp6(2),o.Q6J("src",t.imagen?t.imagen:"assets/fundacion.png",o.LSH),o.xp6(3),o.Oqu(t.titulo),o.xp6(2),o.Q6J("ngForOf",t.productos),o.xp6(4),o.Oqu(t.fundacionDTO.nombre)}}function j(n,s){if(1&n&&(o.TgZ(0,"div",2),o.YNc(1,B,2,0,"div",20),o.TgZ(2,"div")(3,"div",21),o.YNc(4,G,12,4,"div",22),o.qZA()()()),2&n){const t=o.oxw();o.xp6(1),o.Q6J("ngIf",0==t.showColectas.length),o.xp6(3),o.Q6J("ngForOf",t.showColectas)}}function R(n,s){if(1&n){const t=o.EpF();o.TgZ(0,"div",33)(1,"button",34),o.NdJ("click",function(){o.CHM(t);const c=o.oxw();return o.KtG(c.addColecta())}),o.TgZ(2,"mat-icon"),o._uU(3,"add"),o.qZA()()()}}const H=[{path:"",component:(()=>{class n{constructor(t,i,c,r,l,V,k){this.router=t,this.auth=i,this.donacionesService=c,this.fundacionesService=r,this.fb=l,this.productosService=V,this.showErrorService=k,this.colectas=[],this.isMyColectas=!1,this.showColectas=[],this.loading=!0,this.tipos_productos=[],this.optionsFundaciones=[],this.filtros={},"/mis-colectas"==t.url&&(this.isMyColectas=!0),this.formFiltros=l.group({fundacion:[""],codigoPostal:[""],tipoProducto:[""]}),this.filteredOptions=this.formFiltros.controls.fundacion.valueChanges.pipe((0,x.O)(""),(0,M.U)(u=>{const v="string"==typeof u?u:u?.nombre;return v?this._filter(v):this.optionsFundaciones.slice()})),this.userData={isSwapper:i.isUserSwapper()}}ngOnInit(){this.getFundaciones(),this.getTiposProductos(),this.filtrarColectas()}filtrarColectas(){if(this.loading=!0,this.isMyColectas)this.donacionesService.getMisColectas().subscribe({next:t=>{this.colectas=t,this.showColectas=this.colectas,this.showColectas.map(i=>{i.imagen=this.donacionesService.getImagen(i.imagen)}),this.loading=!1},error:t=>{console.log("error mis colectas",t),this.showErrorService.show("Ocurri\xf3 un error!","Ocurri\xf3 un error al traer las colectas de la fundaci\xf3n. Por favor volv\xe9 a intentarlo m\xe1s tarde."),this.loading=!1}});else{this.filtros={};const t=this.formFiltros.controls.fundacion.value?this.formFiltros.controls.fundacion.value.idFundacion:void 0,i=this.formFiltros.controls.codigoPostal.value,c=this.formFiltros.controls.tipoProducto.value;t&&(this.filtros.idFundacion=t),i&&(this.filtros.codigoPostal=i),c&&(this.filtros.tipoProducto=c),this.donacionesService.getAllColectas(this.filtros).subscribe({next:r=>{this.colectas=r,this.showColectas=this.colectas,this.showColectas.map(l=>{l.imagen=this.donacionesService.getImagen(l.imagen)}),this.loading=!1},error:r=>{console.log("error all colectas",r),this.showErrorService.show("Ocurri\xf3 un error!","Ocurri\xf3 un error al traer las colectas. Por favor volv\xe9 a intentarlo m\xe1s tarde."),this.loading=!1}})}}addColecta(){this.auth.isUserLoggedIn?this.router.navigateByUrl("form-colecta"):P().fire({title:"\xa1Necesit\xe1s una cuenta!",text:"Para poder crear una colecta, ten\xe9s que usar la cuenta de una fundaci\xf3n.",icon:"warning",confirmButtonText:"Iniciar sesi\xf3n",showCancelButton:!0,cancelButtonText:"Cancelar"}).then(({isConfirmed:t})=>{t&&this.router.navigate(["login"])})}getFundaciones(){this.fundacionesService.getFundaciones().subscribe(t=>{console.log(t),this.optionsFundaciones=t})}getTiposProductos(){this.productosService.getTiposProductos().subscribe({next:t=>{console.log("productos",t),this.tipos_productos=t},error:t=>{console.error("error",t),this.showErrorService.show("Error!","Ha ocurrido un error al traer los tipos de producto")},complete:()=>console.info("complete")})}limpiarFiltros(){this.formFiltros.reset(),this.filtrarColectas()}displayFn(t){return t&&t.nombre?t.nombre:""}_filter(t){const i=t.toLowerCase();return this.optionsFundaciones.filter(c=>c.nombre.toLowerCase().includes(i))}goToColecta(t){this.router.navigateByUrl("colecta/"+t.idColecta)}}return n.\u0275fac=function(t){return new(t||n)(o.Y36(m.F0),o.Y36(F.e),o.Y36(Z.M),o.Y36(y),o.Y36(a.qu),o.Y36(A.k),o.Y36(w.x))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-colectas"]],decls:7,vars:5,consts:[[3,"title"],["id","main-donaciones"],[1,"row"],["id","form-filtros",3,"formGroup",4,"ngIf"],[3,"loading"],["class","row",4,"ngIf"],["class","floating-button-container",4,"ngIf"],["id","form-filtros",3,"formGroup"],["appearance","outline",1,"example-full-width"],["type","text","matInput","","formControlName","fundacion",2,"border","1px solid red",3,"matAutocomplete"],[3,"displayWith"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline"],["matInput","","formControlName","codigoPostal","type","number"],["formControlName","tipoProducto","panelClass","example-panel"],[2,"text-align","center"],["mat-raised-button","","color","primary",3,"click"],["mat-raised-button","",3,"click"],[3,"value"],["style","text-align: center;",4,"ngIf"],[1,"card-deck"],["class","card row",3,"click",4,"ngFor","ngForOf"],[1,"card","row",3,"click"],[1,"col-sm-4",2,"display","flex","justify-content","center"],[1,"card-img",3,"src"],[1,"card-body","col-sm-6"],[1,"card-title"],[1,"productos"],["class","producto",4,"ngFor","ngForOf"],[1,"card-fundacion","col-sm-2"],["src","assets/fundacion.png",1,"img-fundacion"],[1,"producto"],[1,"floating-button-container"],["mat-fab","","color","primary","aria-label","Agregar Colecta","matTooltip","Agregar Colecta","matTooltipPosition","before",3,"click"]],template:function(t,i){1&t&&(o._UZ(0,"app-header",0),o.TgZ(1,"div",1)(2,"div",2),o.YNc(3,L,23,7,"form",3),o.qZA(),o._UZ(4,"app-spinner",4),o.YNc(5,j,5,2,"div",5),o.YNc(6,R,4,0,"div",6),o.qZA()),2&t&&(o.Q6J("title",i.isMyColectas?"Mis Colectas":"Colectas"),o.xp6(3),o.Q6J("ngIf",!i.isMyColectas),o.xp6(1),o.Q6J("loading",i.loading),o.xp6(1),o.Q6J("ngIf",!i.loading),o.xp6(1),o.Q6J("ngIf",!i.userData.isSwapper))},dependencies:[d.sg,d.O5,g.KE,g.hX,_.Hw,J.Nt,h.lW,h.cs,U.gD,S.ey,C.XC,C.ZL,I.gM,a._Y,a.Fj,a.wV,a.JJ,a.JL,a.sg,a.u,N.G,b.O,d.Ov],styles:["#main-donaciones[_ngcontent-%COMP%]{padding:2%}#main-donaciones[_ngcontent-%COMP%]   #form-filtros[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;justify-items:center;align-items:baseline}#main-donaciones[_ngcontent-%COMP%]   #form-filtros[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{max-width:100%;padding:5px}#main-donaciones[_ngcontent-%COMP%]   #form-filtros[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:2px;max-width:40%}#main-donaciones[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{margin:5px;display:flex;flex-direction:row;align-items:center}#main-donaciones[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]:hover{cursor:pointer}#main-donaciones[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-img[_ngcontent-%COMP%]{max-height:160px;margin:20px;width:auto}#main-donaciones[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .productos[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap}#main-donaciones[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .productos[_ngcontent-%COMP%]   .producto[_ngcontent-%COMP%]{margin:5px 10px;min-width:100px}#main-donaciones[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-fundacion[_ngcontent-%COMP%]{text-align:center}#main-donaciones[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-fundacion[_ngcontent-%COMP%]   .img-fundacion[_ngcontent-%COMP%]{width:30px}#main-donaciones[_ngcontent-%COMP%]   .floating-button-container[_ngcontent-%COMP%]{position:fixed;right:25px;bottom:40px}@media (min-width: 577px) and (max-width: 768px){#form-filtros[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr!important}}@media (min-width: 0px) and (max-width: 576px){#form-filtros[_ngcontent-%COMP%]{grid-template-columns:1fr!important}}"]}),n})()}];let K=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[m.Bz.forChild(H),m.Bz]}),n})();var $=e(5110),z=e(3148),D=e(9499),W=e(4466);let X=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[d.ez,K,$.q,z.IJ,D.O,W.m]}),n})()}}]);